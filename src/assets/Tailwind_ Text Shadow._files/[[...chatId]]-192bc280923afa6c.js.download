(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6],{49529:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat/[[...chatId]]",function(){return t(27277)}])},27277:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSP:function(){return ad},default:function(){return am}});var r,a,o=t(35250),i=t(91530),s=t.n(i),l=t(61432),u=t(70079),c=t(73925),d=t(12762),m=t(98943),f=t(62676),h=t(66285),g="dfw_message_feedback",p=t(74516),v="oai/apps/hasSeenStatusUpdate/".concat("2023-03-25"),x=function(){var e=(0,h.hz)().has("oneoff_status_account"),n=(0,u.useRef)(Boolean(f.m.getItem(v))),t=(0,d.WS)();return(0,u.useEffect)(function(){e&&!n.current&&t&&(t(m.s6.oneOffStatusMessageShown),p.m.warning("You attempted to purchase ChatGPT Plus during an outage. We've issued a refund and apologize for the inconvenience. If youâ€™d like to continue your subscription, please re-subscribe.",{duration:0,hasCloseButton:!0,onRemove:function(){f.m.setItem(v,!0),n.current=!0}}))},[n,e,t]),(0,o.jsx)("div",{})},b=t(96424),y=t.n(b),j=t(79876),w=t(44819),k="oai/apps/hasSeenReleaseAnnouncement",C="2023-03-12";function Z(e){var n=e.hasSeenOnboardingDate;e.isUserPaid;var t=(0,u.useState)(!1),r=t[0],a=t[1],i=(0,h.hz)(),s=(0,l.useRouter)();(0,u.useEffect)(function(){a(function(){return!Boolean(f.m.getItem("".concat(k,"/").concat(C)))&&!!n&&n<new Date(C)})},[n]);var g=(0,u.useCallback)(function(){f.m.setItem("".concat(k,"/").concat(C),!0),a(!1)},[]),p=(0,u.useCallback)(function(){g(),s.replace("/chat?model=".concat(w.f_),void 0,{shallow:!0})},[g,s]),v=(0,d.WS)();return((0,u.useEffect)(function(){r&&v(m.s6.announcementViewed,{content:C})},[r,v]),i.has("model_preview"))?(0,o.jsx)(c.Z,{size:"small",isOpen:r,onModalClose:g,type:"success",title:"",theme:"dark",fullBleed:!0,primaryButton:(0,o.jsx)(c.m,{title:"Try GPT-4",color:"light",onClick:p}),secondaryButton:(0,o.jsx)(c.m,{title:"Maybe later",color:"dark",onClick:g,className:"border-gray-800 hover:border-gray-700"}),className:"sm:max-w-[480px]",children:(0,o.jsx)(N,{})}):null}var N=function(){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(y(),{src:"/images/gpt-4-motif.svg",alt:"Gpt-4 announcement banner",width:"480",height:"160",className:"mt-3.5"}),(0,o.jsx)("div",{className:"m-4 mb-6 flex flex-col gap-6 sm:m-6",children:(0,o.jsxs)("div",{className:"prose prose-invert text-base",children:[(0,o.jsx)("h2",{children:"Introducing GPT-4"}),(0,o.jsxs)("p",{children:["Our latest model,"," ",(0,o.jsx)("a",{href:"https://openai.com/product/gpt-4",target:"_blank",rel:"noreferrer",children:"GPT-4"}),", is now available to Plus subscribers."]}),(0,o.jsx)("p",{children:"GPT-4 has enhanced capabilities in:"}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Advanced reasoning"}),(0,o.jsx)("li",{children:"Complex instructions"}),(0,o.jsx)("li",{children:"More creativity"})]}),(0,o.jsx)("p",{children:"To give every Plus subscriber a chance to try the model, we'll dynamically adjust the cap for GPT-4 usage based on demand."})]})})]})},I=t(61706),P=t(33861),S=t(31501),T=t(61079),M=t(89874),R=t(14806),_=t(25769),F=t(45813),q=t(87093),D=t(6128),E=t(19841),L=t(26649),U=t.n(L),A=t(11253),O=t.n(A),z=t(1454),B=t(34303),V=t(82018),$=t(36613),H=t(68619),G=t(33264),W=t(27252),J={id:"chat",name:"ChatGPT",href:"/chat",theme:{icon:"openai",color:"#10a37f",activeColor:"#1a7f64"}},Y=t(11699),X=t(80836),Q=t(64705),K=t(2827),ee=t(39690);function en(e){var n=e.id,t=e.label;return(0,o.jsxs)("div",{className:"form-check",children:[(0,o.jsx)("input",{className:"form-check-input float-left mt-1 mr-2 h-4 w-4 cursor-pointer appearance-none rounded-sm border border-gray-300 bg-white bg-contain bg-center bg-no-repeat align-top transition duration-200 checked:border-blue-600 checked:bg-blue-600 focus:outline-none",type:"checkbox",value:"",id:n}),(0,o.jsx)("label",{className:"form-check-label inline-block text-gray-800 dark:text-gray-100",htmlFor:n,children:t})]})}var et=t(97374),er=t.n(et),ea=t(54655),eo=t(23119),ei=t(95182),es=t.n(ei);function el(){var e=(0,R.Z)(["text-xs flex items-center justify-center gap-1"]);return el=function(){return e},e}function eu(){var e=(0,R.Z)(["dark:text-white disabled:text-gray-300 dark:disabled:text-gray-400"]);return eu=function(){return e},e}function ec(){var e=(0,R.Z)(["flex-grow flex-shrink-0"]);return ec=function(){return e},e}function ed(e){var n=e.currentPage,t=e.onChangeIndex,r=e.length,a=e.className,i=function(e){t(es()(n+e,0,r-1))};return(0,o.jsxs)(em,{className:a,children:[(0,o.jsx)(ef,{onClick:function(){return i(-1)},disabled:0===n,children:(0,o.jsx)(j.ZP,{size:"xsmall",icon:z.YFh})}),(0,o.jsx)(eh,{children:"".concat(n+1," / ").concat(r)}),(0,o.jsx)(ef,{onClick:function(){return i(1)},disabled:n===r-1,children:(0,o.jsx)(j.ZP,{size:"xsmall",icon:z.Tfp})})]})}var em=B.Z.div(el()),ef=B.Z.button(eu()),eh=B.Z.span(ec()),eg=t(37678);function ep(){var e=(0,R.Z)(["text-center mt-2 flex justify-center"]);return ep=function(){return e},e}var ev=B.Z.div(ep());function ex(e){var n=e.initialText,t=e.role,r=e.threadId,a=e.currentLeaf,i=e.onUpdateNode,s=e.onChangeItemInView,l=e.onExitEdit,c=e.onDeleteNode,f=e.onRequestCompletion,h=e.onCreateEditNode,g=e.disabled,p=(0,d.WS)(),v=(0,u.useId)(),x="".concat(a,"-").concat(v),b=(0,u.useState)(n||""),y=b[0],j=b[1],w=(0,u.useRef)(null);(0,u.useEffect)(function(){h(a,x)},[]);var k=(0,u.useCallback)(function(e){j(e.currentTarget.value)},[]),C=(0,u.useCallback)(function(){i(x,y),s(x),f(H.Os.Next,x,{eventSource:"mouse"},!0),l()},[i,x,y,s,f,l,]),Z=(0,u.useCallback)(function(){c(x),s(a),l(),p(t===H.uU.User?m.s6.cancelEditPrompt:m.s6.cancelEditCompletion,{threadId:r})},[x,a,p,s,c,l,t,r,]);return(0,u.useEffect)(function(){var e=w.current,n=function(e){"Enter"===e.key&&e.metaKey?C():"Escape"===e.key&&Z()};return e&&e.addEventListener("keydown",n),function(){e&&e.removeEventListener("keydown",n)}},[Z,C]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(K.ZP,{ref:w,value:y,onChange:k,className:"m-0 resize-none border-0 bg-transparent p-0 focus:ring-0 focus-visible:ring-0"}),(0,o.jsxs)(ev,{children:[(0,o.jsx)(ee.z,{as:"button",onClick:C,className:"mr-2",disabled:g,children:"Save & Submit"}),(0,o.jsx)(ee.z,{as:"button",color:"neutral",onClick:Z,children:"Cancel"})]})]})}var eb=t(77434),ey=t(47635),ej=t(60363),ew=t(31425);function ek(){var e=(0,R.Z)(["text-xs text-black\n",""]);return ek=function(){return e},e}function eC(){var e=(0,R.Z)(["relative w-full overflow-hidden pt-[67%]"]);return eC=function(){return e},e}function eZ(e){var n=e.title,t=e.url,r=e.imageUrl,a=e.logoUrl,i=e.className,s=e.mini,l=Boolean(r),c=ey.get(new URL(t).hostname),f=(0,d.WS)(),h=(0,u.useCallback)(function(){f(m.s6.carouselCardClick,{content:t})},[f,t]);return(0,o.jsxs)(t?"a":"div",{className:(0,E.Z)("flex h-full w-full flex-col overflow-hidden rounded-md border border-black/10 bg-gray-50 shadow-[0_2px_24px_rgba(0,0,0,0.05)]",i),href:t,target:t?"_blank":"",onClick:h,children:[l&&(0,o.jsx)(eI,{children:(0,o.jsx)("div",{className:"absolute inset-0",children:(0,o.jsx)("img",{src:r,alt:"image of ".concat(n),className:"h-full w-full border-b border-black/10 object-cover"})})}),(0,o.jsxs)("div",{className:"flex flex-1 flex-col justify-between gap-1.5 p-3",children:[(0,o.jsx)(eN,{$clamp:void 0!==s&&s||l,children:n}),(0,o.jsxs)("div",{className:"flex items-center gap-1",children:[a?(0,o.jsx)(ej.Z,{url:a,name:c,size:13}):(0,o.jsx)(ew.Z,{url:t,size:13}),(0,o.jsx)("div",{className:"text-[10px] leading-3 text-gray-500 line-clamp-1",children:c})]})]})]})}var eN=B.Z.div(ek(),function(e){return e.$clamp&&"line-clamp-2"}),eI=B.Z.div(eC()),eP=t(36025),eS=t(41135);function eT(e){var n=e.disabled,t=e.onClick,r=e.left,a=e.children;return(0,o.jsx)("button",{disabled:n,onClick:t,"aria-disabled":n,className:(0,E.Z)("flex h-6 w-[30px] items-center justify-center rounded-full","bg-gray-900 text-white shadow-sm hover:bg-gray-700 disabled:hover:bg-gray-900 dark:bg-white dark:text-gray-900 dark:hover:bg-gray-200 dark:disabled:hover:bg-white","transition-opacity disabled:opacity-20","cursor-pointer disabled:cursor-auto","absolute top-full translate-y-3 lg:top-1/2 lg:-translate-y-1/2",void 0!==r&&r?"left-1/2 -translate-x-[calc(100%+4px)] lg:-left-3 lg:-translate-x-full":"left-1/2 translate-x-1 lg:left-auto lg:-right-3 lg:translate-x-full",n&&"lg:hidden"),children:a})}var eM=t(794),eR=function(e){var n=e.x,t=e.children,r=e.className;return(0,o.jsx)(eM.E.div,{className:(0,E.Z)("mr-3 h-full w-full flex-none sm:w-[calc((100%-12px)/2)] lg:w-[calc((100%-24px)/3)]",r),style:{x:n},children:t})},e_={type:"spring",bounce:0},eF=(0,u.forwardRef)(function(e,n){return(0,o.jsx)("div",{ref:n,className:(0,E.Z)("relative flex h-full w-full overflow-hidden",e.className),children:e.children})});eF.displayName="CarouselContainer";var eq=(r={},(0,P.Z)(r,Y._G.Small,1),(0,P.Z)(r,Y._G.Medium,2),(0,P.Z)(r,Y._G.Large,2),(0,P.Z)(r,Y._G.XLarge,3),(0,P.Z)(r,Y._G.Full,3),r);function eD(e){var n=e.children,t=e.loop,r=void 0===t||t,a=e.className,i=(0,eP.c)(0),s=(0,u.useRef)(null),l=(0,u.useState)(0),c=l[0],d=l[1],m=eq[(0,Y.dQ)()]||1,f=u.Children.count(n)>m,h=u.Children.toArray(n),g=(0,u.useCallback)(function(){var e,n=null===(e=s.current)||void 0===e?void 0:e.clientWidth;return n?-Math.floor(c/m)*(n+12):0},[m,c]),p=(0,u.useCallback)(function(e){var n=m*e;r?d(function(e){return(e+n)%h.length-1}):d(function(e){return es()(e+n,0,h.length-1)})},[h.length,r,m]),v=(0,u.useCallback)(function(){p(1)},[p]),x=(0,u.useCallback)(function(){p(-1)},[p]),b=(0,u.useMemo)(function(){if(r)return[!0,!0];var e=c<h.length-m;return[c>0,e]},[h.length,c,r,m]),y=b[0],w=b[1];return(0,u.useEffect)(function(){return(0,eS.j)(i,g(),e_).stop},[g,c,i]),(0,o.jsxs)("div",{className:(0,E.Z)("relative h-full w-full",a,f&&"mb-12 lg:mb-0"),children:[(0,o.jsx)(eF,{ref:s,children:h.map(function(e,n){return(0,o.jsx)(eR,{x:i,children:e},n)})}),f&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eT,{onClick:x,left:!0,disabled:!y,children:(0,o.jsx)(j.ZP,{icon:z.YFh})}),(0,o.jsx)(eT,{onClick:v,disabled:!w,children:(0,o.jsx)(j.ZP,{icon:z.Tfp})})]})]})}var eE=t(76678),eL=new Set(["og:site_name","og:title","og:description","og:image","og:url",]),eU={"og:site_name":"metadataTitle","og:title":"title","og:description":"description","og:image":"imageUrl","og:url":"url"},eA=/https:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g,eO=u.memo(function(e){var n,t,r,a,i=e.urls,s=(0,eE.Z)(),l=(n={urls:i},t=n.urls,r=(0,V.kP)().session,a=(0,eb.h)({queries:t.map(function(e){return{queryKey:["opengraph",e],queryFn:(0,I.Z)(function(){return(0,F.__generator)(this,function(n){switch(n.label){case 0:return[4,G.ZP.getPageMetadata({url:e})];case 1:return[2,n.sent()]}})}),enabled:Boolean(e&&(null==r?void 0:r.accessToken)),retry:!1}})}),(0,u.useMemo)(function(){return a.map(function(e,n){var r,a=e.data,o=e.isError,i=e.isLoading,s=t[n];if(o||i)return null;var l=a.tags.reduce(function(e,n){return eL.has(n.type)&&(e[eU[n.type]]=n.value),e},{}),u=s.split(/[#?]/)[0],c=null===(r=l.url)||void 0===r?void 0:r.endsWith("/login"),d=l.url&&"/"===new URL(l.url||"").pathname;return u!==l.url&&(c||d)?null:(l.url=s,l)}).filter(Boolean)},[a,t])),c=(0,u.useMemo)(function(){return!l.some(function(e){return Boolean(null==e?void 0:e.imageUrl)})},[l]),d=(0,u.useMemo)(function(){return s.reduce(function(e,n){return e[ey.get(n.domain)]=n.manifest.logo_url,e},{})},[s]),m=(0,u.useMemo)(function(){return l.map(function(e){if(!e)return null;var n,t=ey.get(new URL(e.url).hostname);return t in d&&(n=d[t]),(0,o.jsx)(eZ,{title:e.title||"",url:e.url,imageUrl:e.imageUrl,logoUrl:n,mini:c},e.url)})},[l,c,d]);return 0===l.length?null:(0,o.jsx)(eD,{loop:!1,children:m})}),ez=t(44525);function eB(){var e=(0,R.Z)(["\npy-2 px-3 border text-gray-600 rounded-md text-sm dark:text-gray-100\n","\n","\n","\n"]);return eB=function(){return e},e}var eV=u.memo(function(e){var n,t=e.message,r=e.isEditing,a=e.format,i=e.isCompletionInProgress,s=e.className,l=e.onSandboxLinkClick,u=e.isCompletion,c=e.isResponseToPluginMessage,d=(0,M.Z)(e,["message","isEditing","format","isCompletionInProgress","className","onSandboxLinkClick","isCompletion","isResponseToPluginMessage"]);return r?(0,o.jsx)(ex,(0,S.Z)({currentLeaf:t.nodeId,initialText:X.Cv.getTextFromMessage(t.message),role:X.Cv.getRoleFromMessage(t.message)},d)):(0,o.jsx)(e$,{text:X.Cv.getTextFromMessage(t.message),errCode:t.errCode,err:t.err,flag:t.errType,isCompletionInProgress:i,format:a,className:s,citations:null===(n=t.message.metadata)||void 0===n?void 0:n.citations,isCompletion:u,onSandboxLinkClick:l,id:t.nodeId,onRequestMoreCompletions:d.onRequestMoreCompletions,threadId:d.threadId,showExtractedLinkCards:c})});function e$(e){var n,t,r,a=e.citations,i=e.className,s=e.err,l=e.errCode,c=e.flag,d=e.format,m=e.isCompletionInProgress,f=e.size,g=e.text,p=e.onSandboxLinkClick,v=e.isCompletion,x=e.id,b=e.onRequestMoreCompletions,y=e.threadId,j=e.showExtractedLinkCards,k=l===$.Dd,C=(0,h.hz)(),Z=(t=(n={text:g,isCompletionInProgress:m}).text,r=n.isCompletionInProgress,(0,u.useMemo)(function(){if(r)return[];var e=t.match(eA);return Array.from(new Set(e))},[r,t])),N=(0,u.useMemo)(function(){switch(l){case $.Dd:return(0,o.jsx)(eJ,{$flag:c,children:(0,o.jsx)(eW,{})});case w.uU:if(C.has("model_preview"))return(0,o.jsx)(eG,{id:x,onRequestMoreCompletions:b,flag:c,threadId:y});return(0,o.jsx)(eJ,{$flag:c,children:s});default:return(0,o.jsx)(eJ,{$flag:c,children:s})}},[s,l,C,c,x,b,y]);return(0,o.jsxs)("div",{className:(0,E.Z)(i,"flex flex-col items-start gap-4 whitespace-pre-wrap","danger"===c&&"flex flex-row gap-2 text-red-500","warning"===c&&"text-orange-500"),children:[s&&!g||k||!d?"danger"===c&&k?null:g:(0,o.jsx)(ez.Z,{size:void 0===f?"medium":f,className:(0,E.Z)("danger"!==c&&m&&"result-streaming","danger"===c&&"text-red-500","warning"===c&&"text-orange-500"),onSandboxLinkClick:p,children:""===g?"&#8203;":(0,eg.Qd)(g,a)}),v&&j&&Z.length>0&&(0,o.jsx)(eO,{urls:Z}),c&&N]})}function eH(e){var n=e&&new Date(e),t=n&&new Date(n);return t?"after ".concat(t.getHours()%12||12,":").concat(10>t.getMinutes()?"0":"").concat(t.getMinutes()," ").concat(t.getHours()>=12?"PM":"AM"):"later"}function eG(e){var n=e.id,t=e.onRequestMoreCompletions,r=e.flag,a=e.threadId,i=(0,l.useRouter)(),s=(0,w.CS)(function(e){return e.isoDate}),c=eH(s),d=(0,u.useCallback)(function(){t(n,{eventSource:"mouse"},!0,!1)},[n,t]),m=(0,u.useCallback)(function(){a?(0,w.m0)(a):i.replace("/chat",void 0,{shallow:!0}),t(n,{eventSource:"mouse"},!0,!0)},[n,t,i,a]),f=s?(0,o.jsxs)("span",{children:["You've reached the current usage cap for GPT-4. You can continue with the default model now, or try again ".concat(c,".")," ",(0,o.jsx)("a",{href:"https://share.hsforms.com/16d0ZZVM3QZirXnCD_q7u1Q4sk30",target:"_blank",rel:"noreferrer",className:"underline",children:"Learn more"})]}):"You previously reached your usage cap for GPT-4, but you can now try sending your message again";return(0,o.jsx)(eJ,{$flag:Boolean(s)&&r,children:(0,o.jsxs)("div",{className:"flex items-center gap-6",children:[f,!s&&(0,o.jsx)(ee.z,{color:"light",className:"flex-shrink-0 bg-white",onClick:d,children:"Try again"}),s&&(0,o.jsx)(ee.z,{color:"light",className:"flex-shrink-0 bg-white",onClick:m,children:"Use default model"})]})})}function eW(){return(0,o.jsxs)(o.Fragment,{children:["This content may violate our"," ",(0,o.jsx)("a",{target:"_blank",href:"https://platform.openai.com/docs/usage-policies/content-policy",rel:"noreferrer",className:"bold underline",children:"content policy"}),". If you believe this to be in error, please"," ",(0,o.jsx)("a",{target:"_blank",href:"https://forms.gle/3gyAMj5r5rTEcgbs5",rel:"noreferrer",className:"bold underline",children:"submit your feedback"})," ","â€” your input will aid our research in this area."]})}var eJ=B.Z.div(eB(),function(e){return"warning"===e.$flag&&"border-orange-500 bg-orange-500/10"},function(e){return"danger"===e.$flag&&"border-red-500 bg-red-500/10"},function(e){return!e.$flag&&"border-green-500 bg-green-500/10"});function eY(e){var n=e.messages,t=e.isCompletionInProgress,r=e.isCompletion,a=e.onRequestMoreCompletions,i=n.reduce(function(e,n){return n.err?e:e+X.Cv.getTextFromMessage(n.message)},"");return(0,o.jsx)(e$,{text:i,format:!0,isCompletion:r,isCompletionInProgress:t,id:"",threadId:"",onRequestMoreCompletions:a})}function eX(){var e=(0,R.Z)([""]);return eX=function(){return e},e}function eQ(){var e=(0,R.Z)(["flex flex-grow flex-col gap-3"]);return eQ=function(){return e},e}function eK(){var e=(0,R.Z)(["text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-2xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0"]);return eK=function(){return e},e}function e0(){var e=(0,R.Z)(["w-[30px] flex flex-col relative items-end"]);return e0=function(){return e},e}function e1(){var e=(0,R.Z)(["p-2 rounded-md hover:bg-gray-200 hover:text-gray-800 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-200 flex items-center gap-2"]);return e1=function(){return e},e}function e2(){var e=(0,R.Z)(["p-1 rounded-md hover:bg-gray-100 hover:text-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-gray-200 disabled:dark:hover:text-gray-400"]);return e2=function(){return e},e}function e3(){var e=(0,R.Z)(["text-gray-400 flex self-end lg:self-center justify-center mt-2 gap-3 md:gap-4 lg:gap-1 lg:absolute lg:top-0 lg:translate-x-full lg:right-0 lg:mt-0 lg:pl-2\n",""]);return e3=function(){return e},e}function e4(){var e=(0,R.Z)(["text-center border-b p-3 text-gray-500 dark:border-black/20 dark:text-gray-400 text-xs"]);return e4=function(){return e},e}function e6(){var e=(0,R.Z)(["flex justify-between items-center p-4 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm invisible lg:visible"]);return e6=function(){return e},e}var e5,e7=er()(function(){return t.e(328).then(t.bind(t,63328))},{loadableGenerated:{webpack:function(){return[63328]}},ssr:!1}),e8=er()(function(){return t.e(736).then(t.bind(t,98736))},{loadableGenerated:{webpack:function(){return[98736]}},ssr:!1}),e9=er()(function(){return t.e(24).then(t.bind(t,6024))},{loadableGenerated:{webpack:function(){return[6024]}},ssr:!1}),ne=er()(function(){return t.e(672).then(t.bind(t,37672))},{loadableGenerated:{webpack:function(){return[37672]}},ssr:!1}),nn=er()(function(){return t.e(201).then(t.bind(t,20201))},{loadableGenerated:{webpack:function(){return[20201]}},ssr:!1});function nt(e){var n,t;return!(null===(n=e.message.recipient)||void 0===n?void 0:n.includes("."))&&(null===(t=e.message.recipient)||void 0===t?void 0:t.slice(2,3))==="n"}function nr(e){var n,t,r;return!(null===(n=e.message.recipient)||void 0===n?void 0:n.includes("."))&&((null===(t=e.message.recipient)||void 0===t?void 0:t.slice(2,3))==="o"||(null===(r=e.message.recipient)||void 0===r?void 0:r.slice(2,3))==="s")}function na(e){var n,t;return!("o"!==e.message.content.content_type.slice(1,2)&&((null===(n=e.message.recipient)||void 0===n?void 0:n.includes("."))||(null===(t=e.message.recipient)||void 0===t?void 0:t.slice(2,3))!=="t"||"text"!==e.message.content.content_type))}function no(e){return"e"===e.message.content.content_type.slice(2,3)}function ni(e){var n,t,r=(null===(n=e.message.author)||void 0===n?void 0:n.name)||(null===(t=e.message.user)||void 0===t?void 0:t.name);return!(null==r?void 0:r.includes("."))&&((null==r?void 0:r.slice(2,3))==="n"||(null==r?void 0:r.slice(2,3))==="o"||(null==r?void 0:r.slice(2,3))==="s")}function ns(e){var n;return X.Cv.getRoleFromMessage(e.message)===H.uU.Assistant&&(null===(n=e.message.recipient)||void 0===n?void 0:n.includes("."))}function nl(e){return X.Cv.getRoleFromMessage(e.message)===H.uU.Tool&&!ni(e)&&!no(e)}(e5=a||(a={}))[e5.Text=0]="Text",e5[e5.MultiText=1]="MultiText",e5[e5.SB=2]="SB",e5[e5.B=3]="B",e5[e5.C=4]="C",e5[e5.CEO=5]="CEO",e5[e5.P=6]="P";var nu=u.memo(function(e){var n,t,r=e.turn,i=e.isFinalTurn,s=e.threadId,l=e.treeRef,c=e.onChangeItemInView,f=e.onChangeRating,g=e.onRequestMoreCompletions,p=e.onDeleteNode,v=e.onRequestCompletion,x=e.onUpdateNode,b=e.onSandboxLinkClick,y=e.onHandleChangeVariantFeedbackInlineComparisonRating,k=e.activeRequests,C=e.inlineFeedbackDisplay,Z=void 0!==C&&C,N=e.modelBackend,I=r.role,P=r.messages,M=r.variantIds,R=(0,u.useState)(P),_=R[0],F=R[1],q=J.theme,D=q.color,L=q.icon,U=q.activeColor,A=(0,V.kP)().session,B=(0,Y.dD)(),$=(0,Y.lj)(),G=(0,d.WS)(),W=(0,u.useState)(!1),Q=W[0],K=W[1],ee=(0,u.useMemo)(function(){return M.findIndex(function(e){return e===_[0].nodeId})},[M,_]),en=I!==H.uU.User,et=_[_.length-1],er=(0,u.useState)(et.rating),ei=er[0],es=er[1],el=(0,h.hz)(),eu=(0,eE.Z)(),ec=(0,u.useCallback)(function(){1===_.length&&(G(I===H.uU.User?m.s6.editPrompt:m.s6.editCompletion,{id:_[0].message.id,threadId:s}),K(!0))},[_,G,I,s]),em=(0,u.useCallback)(function(){K(!1)},[]),ef=(0,u.useCallback)(function(e){f(et.nodeId,et.message.id,e),es(e)},[et,f]),eh=(0,u.useState)(et.inlineComparisonRating),eg=eh[0],ep=eh[1];(0,u.useEffect)(function(){es(et.rating),ep(et.inlineComparisonRating)},[et]),(0,u.useEffect)(function(){F(P)},[P]);var ev=(0,u.useMemo)(function(){return X.Cv.getRequestIdFromConversationTurn(r)},[r]),ex="CompletionUpdated:".concat(_[_.length-1].nodeId),eb=(0,u.useCallback)(function(e,n){var t=n.nodeId;F(function(e){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var u=i.value;if(u.nodeId===t){var c=l.current.getNode(t);n.push((0,S.Z)({nodeId:t,parentId:c.parentId,message:c.message},c.metadata))}else n.push(u)}}catch(d){a=!0,o=d}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n})},[l]);(0,u.useEffect)(function(){var e=O().subscribe(ex,eb);return function(){O().unsubscribe(e)}},[eb,ex]);var ey=(0,u.useMemo)(function(){return k.has(ev)},[k,ev]),ej=(0,u.useMemo)(function(){var e=!0,n=!1,t=void 0;try{for(var r,a=_[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value;if(o.errType)return o.errType}}catch(i){n=!0,t=i}finally{try{e||null==a.return||a.return()}finally{if(n)throw t}}return!1},[_]),ew=(0,u.useMemo)(function(){if(en){var e,n,t=null===(e=l.current.getParentPromptNode(_[0].nodeId))||void 0===e?void 0:e.parentId,r=t&&(null===(n=l.current.getNode(t).message.metadata)||void 0===n?void 0:n.model_slug),a=(null==_?void 0:_[0])&&X.Cv.getModelFromMessage(null==_?void 0:_[0].message);if(a&&r&&a!==r)return"The previous model used in this conversation is unavailable. We've switched you to the latest default model"}return null},[en,_,l]),ek=(0,u.useMemo)(function(){if(!el.has("tools")&&!el.has("tools2")&&!el.has("tools3"))return{avatarIcon:L,avatarColor:D};if(ey&&_.length>0){var e=_[_.length-1];if(nt(e)||nr(e)||ni(e))return{avatarIcon:"s",avatarColor:U};if(na(e)||no(e))return{avatarIcon:"c",avatarColor:U};if(ns(e)||nl(e)){var n=ns(e)?e.message.recipient:e.message.author.name,t=null==n?void 0:n.split(".")[0],r=eu.find(function(e){return e.namespace===t});return r?{avatarPlugin:r}:{avatarIcon:"p",avatarColor:U}}else if(X.Cv.getIsTextTypeFromMessage(e.message)&&(X.Cv.getTextFromMessage(e.message).length>0||_.length>1))return{avatarIcon:"t",avatarColor:U}}return{avatarIcon:L,avatarColor:D}},[el,ey,_,L,D,U,eu,]),eC=ek.avatarIcon,eZ=ek.avatarColor,eN=ek.avatarPlugin,eI=(0,u.useCallback)(function(e,n){var t=l.current.getParentId(e);l.current.addNode(n,"",t,H.Jq.Prompt)},[l]),eP=(0,u.useMemo)(function(){var e=[];return _.forEach(function(n,t){var r=null==_?void 0:_[t-1],o=r&&(X.Cv.getIsIncompleteFromMessage(r.message)||X.Cv.getIsContinuedFromMessage(r.message)),i=X.Cv.getIsContinuedFromMessage(n.message),s=X.Cv.getIsTextTypeFromMessage(n.message)&&X.Cv.getTextFromMessage(n.message);if(o&&i&&s){var l=e.pop();(null==l?void 0:l.type)===a.MultiText?(l.messages.push(n),e.push(l)):(null==l?void 0:l.type)===a.Text&&e.push({type:a.MultiText,messages:[l.message,n]})}else if(nt(n)||nr(n)||ni(n)){var u=e[e.length-1];(null==u?void 0:u.type)===a.SB||(null==u?void 0:u.type)===a.B?u.messages.push(n):e.push({type:nt(n)?a.SB:a.B,messages:[n]})}else if(ns(n)||nl(n)){var c=e[e.length-1];nl(n)&&(null==c?void 0:c.type)===a.P?c.messages.push(n):e.push({type:a.P,messages:[n]})}else{var d=a.Text;na(n)?d=a.C:no(n)&&(d=a.CEO),e.push({type:d,message:n})}}),e.map(function(n,t){var r,i=t===e.length-1;switch(n.type){case a.Text:return(0,o.jsx)(eV,{className:"min-h-[20px]",message:n.message,isEditing:Q,format:en,isCompletionInProgress:i&&ey,onCreateEditNode:eI,threadId:s,onUpdateNode:x,onDeleteNode:p,onChangeItemInView:c,onRequestCompletion:v,onExitEdit:em,disabled:0!==k.size,onSandboxLinkClick:b,isCompletion:en,onRequestMoreCompletions:g,isResponseToPluginMessage:(null===(r=e[t-1])||void 0===r?void 0:r.type)===a.P},n.message.nodeId);case a.MultiText:return(0,o.jsx)(eY,{messages:n.messages,isCompletionInProgress:i&&ey,isCompletion:en},t);case a.SB:if(!el.has("tools"))return null;return(0,o.jsx)(e7,{messages:n.messages},n.messages[0].nodeId);case a.B:if(!el.has("tools"))return null;return(0,o.jsx)(e8,{messages:n.messages,isComplete:!i},n.messages[0].nodeId);case a.C:if(!el.has("tools2"))return null;var l=e[t+1],u=l&&l.type===a.CEO?l.message:void 0;return(0,o.jsx)(e9,{message:n.message,outputMessage:u},n.message.nodeId);case a.CEO:if(!el.has("tools2"))return null;return(0,o.jsx)(ne,{message:n.message,isCollapsed:!1},n.message.nodeId);case a.P:if(!el.has("tools3"))return null;return(0,o.jsx)(nn,{messages:n.messages},n.messages[0].nodeId);default:return null}})},[_,Q,en,ey,eI,s,x,p,c,v,em,k.size,b,g,el,]),eS=(0,u.useMemo)(function(){return en&&(null==_?void 0:_[0])&&X.Cv.getModelFromMessage(null==_?void 0:_[0].message)||N},[en,_,N]),eT=!$&&!B&&en&&!Z&&!Q&&1===ee&&i&&null==eg&&null==ei&&2===M.length&&Date.now()-(null!==(n=et.message.create_time)&&void 0!==n?n:0)*1e3<6e5&&!ey&&el.has("dfw_inline_message_regen_comparison"),eM=(0,u.useRef)(Date.now()),eR=(0,u.useRef)((null!==(t=et.message.create_time)&&void 0!==t?t:Date.now())*1e3),e_=(0,u.useRef)(Date.now());(0,u.useEffect)(function(){ey||(e_.current=Date.now())},[ey]);var eF=(0,u.useCallback)(function(e){if(eT){var n,t,r,a,o=M[0]||"",i=(null===(n=l.current)||void 0===n?void 0:n.getConversationTurns(o))||[],s=i[i.length-1],u=(null==s?void 0:s.messages)||[],c=u[u.length-1],d=(null==c?void 0:null===(t=c.message)||void 0===t?void 0:t.id)||"",m=M[1]||"",f=(null===(r=l.current)||void 0===r?void 0:r.getConversationTurns(m))||[],h=f[f.length-1],g=(null==h?void 0:h.messages)||[],p=g[g.length-1];y(d,(null==p?void 0:null===(a=p.message)||void 0===a?void 0:a.id)||"",e,eM.current,eM.current,eR.current,e_.current),l.current.updateNode(et.nodeId,{metadata:{$set:(0,T.Z)((0,S.Z)({},l.current.getMetadata(et.nodeId)),{inlineComparisonRating:e})}}),ep(e),l.current.updateNode(c.nodeId,{metadata:{$set:(0,T.Z)((0,S.Z)({},l.current.getMetadata(c.nodeId)),{inlineComparisonRating:"baseline"})}})}},[eT,et.nodeId,y,l,M,]),eq=(0,u.useCallback)(function(){l.current.updateNode(et.nodeId,{metadata:{$set:(0,T.Z)((0,S.Z)({},l.current.getMetadata(et.nodeId)),{inlineComparisonRating:"skip"})}}),ep("skip")},[et.nodeId,l]);return(0,o.jsxs)(nc,{className:(0,E.Z)("group","w-full text-gray-800 dark:text-gray-100",Z?"":"border-b border-black/10 dark:border-gray-900/50",en?"bg-gray-50 dark:bg-[#444654]":"dark:bg-gray-800"),children:[ew&&(0,o.jsx)(nv,{children:ew}),(0,o.jsxs)(nm,{className:(0,E.Z)(Z?"":"m-auto"),children:[(0,o.jsxs)(nf,{children:[en?eN?(0,o.jsx)(eo.Ph,{plugin:eN,notice:ej||void 0}):(0,o.jsx)(eo.k$,{background:el.has("model_preview")&&eS===w.f_?"black":eZ||"",iconName:eC,notice:ej||void 0}):(0,o.jsx)(eo.Yt,{user:null==A?void 0:A.user,notice:ej||void 0}),M.length>1&&!$&&!Z&&(0,o.jsx)(ed,{currentPage:ee,onChangeIndex:function(e){return c(M[e])},length:M.length,className:"invisible absolute left-0 top-2 -ml-4 -translate-x-full group-hover:visible"})]}),(0,o.jsxs)("div",{className:"relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]",children:[(0,o.jsx)(nd,{children:eP}),!en&&!Z&&1===_.length&&!Q&&(0,o.jsx)(np,{$hidden:0!==k.size,children:(0,o.jsx)(ng,{onClick:ec,className:"md:invisible md:group-hover:visible",children:(0,o.jsx)(j.ZP,{icon:z.vPQ})})}),(0,o.jsxs)("div",{className:"flex justify-between",children:[M.length>1&&$&&!Z&&(0,o.jsx)(ed,{currentPage:ee,onChangeIndex:function(e){return c(M[e])},length:M.length,className:"self-center pt-2"}),en&&!Z&&(0,o.jsxs)(np,{$hidden:ey,children:["thumbsDown"!==ei&&(0,o.jsx)(ng,{onClick:function(){return ef("thumbsUp")},disabled:"thumbsUp"===ei,className:(0,E.Z)("thumbsUp"===ei&&"!dark:text-gray-200 bg-gray-100 text-gray-700 dark:bg-gray-700"),children:(0,o.jsx)(j.ZP,{icon:z.fmn})},"thumbsUp:".concat(et.nodeId)),"thumbsUp"!==ei&&(0,o.jsx)(ng,{onClick:function(){return ef("thumbsDown")},disabled:"thumbsDown"===ei,className:(0,E.Z)("thumbsDown"===ei&&"!dark:text-gray-200 bg-gray-100 text-gray-700 dark:bg-gray-700"),children:(0,o.jsx)(j.ZP,{icon:z.oLd})},"thumbsDown:".concat(et.nodeId))]}),eT&&(0,o.jsxs)(nx,{children:[(0,o.jsx)("div",{className:(0,E.Z)("mr-4"),children:"Was this response better or worse?"}),(0,o.jsxs)(nh,{onClick:function(){return eF("new")},title:"This response was better than the previous response",children:[(0,o.jsx)(j.ZP,{icon:z.fmn,className:(0,E.Z)("mr-1")}),"Better"]}),(0,o.jsxs)(nh,{onClick:function(){return eF("original")},title:"This response was worse than the previous response",children:[(0,o.jsx)(j.ZP,{icon:z.oLd,className:(0,E.Z)("mr-1")}),"Worse"]}),(0,o.jsxs)(nh,{onClick:function(){return eF("same")},title:"This response was the same in quality",children:[(0,o.jsx)(j.ZP,{icon:ea.Ny3,className:(0,E.Z)("mr-1 rounded-full border border-gray-400 dark:border-gray-300")}),"Same"]}),(0,o.jsx)(nh,{onClick:eq,title:"Skip this comparison",children:(0,o.jsx)(j.ZP,{icon:z.q5L,size:"medium"})})]})]})]})]})]})}),nc=B.Z.div(eX()),nd=B.Z.div(eQ()),nm=B.Z.div(eK()),nf=B.Z.div(e0()),nh=B.Z.button(e1()),ng=B.Z.button(e2()),np=B.Z.div(e3(),function(e){return e.$hidden?"invisible":"visible"}),nv=B.Z.div(e4()),nx=B.Z.div(e6());function nb(){var e=(0,R.Z)(["mb-2 mt-auto ml-auto mr-auto"]);return nb=function(){return e},e}function ny(){var e=(0,R.Z)(["relative rounded-md border border-black/10 bg-gray-50 dark:border-gray-900/50 dark:bg-[#444654] flex flex-col overflow-hidden"]);return ny=function(){return e},e}function nj(){var e=(0,R.Z)(["mb-5 rounded-md border dark:bg-gray-800 overflow-hidden"]);return nj=function(){return e},e}function nw(){var e=(0,R.Z)(["ml-5"]);return nw=function(){return e},e}function nk(){var e=(0,R.Z)(["ml-5"]);return nk=function(){return e},e}function nC(e){var n,t,r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(null==e?void 0:null===(n=e.messages)||void 0===n?void 0:n.length)===1&&!(null==e?void 0:null===(t=e.messages)||void 0===t?void 0:t.some(function(e){return"error"in e}))&&(!a||!((null==e?void 0:null===(r=e.messages)||void 0===r?void 0:r.length)===1&&X.Cv.getTextFromMessage(null==e?void 0:e.messages[0].message).length<20))}function nZ(e){var n,t,r,a,i,l=e.treeRef,f=e.ratingModalNodeId,p=e.ratingModalOpen,v=e.setRatingModalOpen,x=e.handleSubmitFeedback,b=e.onHandleChangeFeedbackComparisonRating,y=e.setCurrentLeafId,j=e.feedbackTextareaRef,w=e.threadIdRef,k=e.activeRequests,C=e.modelBackend,Z=e.onChangeItemInView,N=e.onRequestMoreCompletions,I=e.onDeleteNode,P=e.onRequestCompletion,M=e.onUpdateNode,R=e.onSandboxLinkClick,_=(0,u.useRef)(.5>Math.random()?"left":"right"),F=null===(n=l.current)||void 0===n?void 0:n.getConversationTurns(f||"root"),q=F[F.length-1],D=(0,u.useState)("critique"),L=D[0],U=D[1],A=(0,Y.lj)(),O=(0,h.hz)().has(g)&&nC(q,!0)&&!A,B=(0,d.WS)(),V=(0,u.useMemo)(function(){return{id:f||"root",threadId:w.current||"root",rating:p,model:C}},[f,w,p,C]),$=null==F?void 0:F[(null==F?void 0:F.length)-1].variantIds,H=null==$?void 0:$[(null==$?void 0:$.length)-1],G=(a=(r=null===(t=l.current)||void 0===t?void 0:t.getConversationTurns(H))[r.length-1]).messages[a.messages.length-1].nodeId,W=null===(i=l.current)||void 0===i?void 0:i.getConversationTurns(G),J=(0,u.useMemo)(function(){var e=null==W?void 0:W[(null==W?void 0:W.length)-1];return"thumbsDown"===p&&O&&nC(e)&&nC(q)},[p,O,W,q,]),et=(0,u.useRef)(Date.now()),er=(0,u.useRef)(-1),ea=(0,u.useRef)(Date.now()),eo=(0,u.useRef)(Date.now());(0,u.useEffect)(function(){"compare"===L?(er.current=Date.now(),B(m.s6.displayedComparisonUIV0,V)):"critique"===L&&"thumbsDown"===p&&B(m.s6.displayedThumbsDownFeedbackForm,V)},[L]);var ei=F[F.length-2],es=W[W.length-1],el=(0,u.useMemo)(function(){return es&&X.Cv.getRequestIdFromConversationTurn(es)},[es]),eu=(0,u.useMemo)(function(){return k.has(el)},[k,el]);(0,u.useMemo)(function(){eu||(eo.current=Date.now())},[eu]);var ec=q.messages,ed=ec[ec.length-1],em=ed.message.id,ef=ed.nodeId,eh=l.current.getLeafFromNode(ef),eg=es.messages,ep=eg[eg.length-1],ev=ep.message.id,ex=ep.nodeId,eb=l.current.getLeafFromNode(ex),ey=(0,u.useRef)([]),ej=(0,u.useRef)(""),ew=(0,u.useCallback)(function(){var e,n=null===(e=j.current)||void 0===e?void 0:e.elements;ey.current=(0,Q.Z)(n||[]).filter(function(e){return e.checked}).map(function(e){return e.id}).map(function(e){return e.replace("feedback-","")}),ej.current=(null==n?void 0:n["feedback-other"].value)||"",x(ej.current,ey.current),"thumbsDown"===p&&B(m.s6.submitThumbsDownFeedbackForm,V),J?U("compare"):v(void 0)},[J,B,V,j,x,p,v,]),ek="critique"===L?(0,o.jsx)(c.m,{title:"Submit feedback",onClick:ew}):null,eC="left"===_.current?es:q,eZ="left"===_.current?q:es,eN="left"===_.current?"new":"original",eI="left"===_.current?"original":"new",eP="left"===_.current?"New Answer":"Original Answer",eS="left"===_.current?"Original Answer":"New Answer",eT="left"===_.current?"New answer is better":"Original answer is better",eM="left"===_.current?"Original answer is better":"New answer is better",eR=(0,u.useCallback)(function(e){var n="left"===e?eN:"right"===e?eI:"same";if(B(m.s6.submittedComparisonUIV0,Object.assign({},V,{choice:n})),p){var t=l.current.getMetadata(ef);l.current.updateNode(ef,{metadata:{$set:(0,T.Z)((0,S.Z)({},t),{inlineComparisonRating:"baseline"})}});var r=l.current.getMetadata(ex);l.current.updateNode(ex,{metadata:{$set:(0,T.Z)((0,S.Z)({},r),{inlineComparisonRating:n})}}),b(em,ev,p,n,_.current,et.current,er.current,ea.current,eo.current,ej.current,ey.current)}y(e===_.current?eb.id:eh.id),v(void 0)},[eN,eI,B,V,p,y,eb.id,eh.id,v,l,ef,ex,b,em,ev,]),e_=!eu&&null!=eo.current&&J,eF=(0,u.useCallback)(function(){v(void 0),"critique"===L?B(m.s6.skippedThumbsDownFeedbackForm,Object.assign({},V)):"compare"===L&&B(m.s6.skippedComparisonUIV0,Object.assign({},V))},[v,B,V,L]);return(0,o.jsxs)(c.Z,{isOpen:!0,onModalClose:eF,closeButton:(0,o.jsx)(ee.z,{as:"button",color:"neutral",onClick:eF,children:(0,o.jsx)(z.q5L,{})}),type:"critique"===L?"thumbsUp"===p?"success":"danger":"success",icon:"critique"===L?"thumbsUp"===p?z.fmn:z.oLd:void 0,title:"critique"===L?"Provide additional feedback":"Pick the best answer to improve the model",primaryButton:ek,size:"larger",children:["critique"===L&&(0,o.jsxs)("form",{ref:j,children:[(0,o.jsx)(K.ZP,{id:"feedback-other",placeholder:"thumbsUp"===p?"What do you like about the response?":"What was the issue with the response? How could it be improved?",rows:3,className:"mt-4 mb-1 w-full rounded-md dark:bg-gray-800 dark:focus:border-white dark:focus:ring-white"}),"thumbsDown"===p&&(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)(en,{id:"feedback-harmful",label:"This is harmful / unsafe"}),(0,o.jsx)(en,{id:"feedback-false",label:"This isn't true"}),(0,o.jsx)(en,{id:"feedback-not-helpful",label:"This isn't helpful"})]})]}),"compare"===L&&W&&w.current&&(0,o.jsxs)("div",{className:(0,E.Z)("w-full"),children:[(0,o.jsx)("p",{className:(0,E.Z)("mt-3 mb-7"),children:"The conversation will continue with the answer you choose."}),(0,o.jsx)(nP,{children:(0,o.jsx)(nT,{children:(0,o.jsx)(nu,{modelBackend:C,turn:ei,isFinalTurn:!1,threadId:w.current,treeRef:l,onChangeItemInView:Z,onChangeRating:s(),onRequestMoreCompletions:N,onDeleteNode:I,onRequestCompletion:P,onUpdateNode:M,onSandboxLinkClick:R,activeRequests:k,inlineFeedbackDisplay:!0,onHandleChangeVariantFeedbackInlineComparisonRating:s()})})}),(0,o.jsxs)("div",{className:(0,E.Z)(),children:[(0,o.jsxs)("div",{className:(0,E.Z)("mb-2 grid w-full grid-cols-2 gap-5"),children:[(0,o.jsx)("div",{children:(0,o.jsx)("p",{className:(0,E.Z)("font-semibold"),children:eP})}),(0,o.jsx)("div",{children:(0,o.jsx)("p",{className:(0,E.Z)("font-semibold"),children:eS})})]}),(0,o.jsxs)("div",{className:(0,E.Z)("mb-5 grid w-full grid-cols-2 gap-5"),children:[(0,o.jsxs)(nI,{children:[(0,o.jsx)(nS,{children:(0,o.jsx)(nu,{modelBackend:C,turn:eC,isFinalTurn:!0,threadId:w.current,treeRef:l,onChangeItemInView:Z,onChangeRating:s(),onDeleteNode:I,onRequestMoreCompletions:N,onRequestCompletion:P,onUpdateNode:M,onSandboxLinkClick:R,activeRequests:k,inlineFeedbackDisplay:!0,onHandleChangeVariantFeedbackInlineComparisonRating:s()})}),(0,o.jsx)(nN,{children:(0,o.jsx)(c.m,{disabled:!e_,title:eT,onClick:function(){return eR("left")},color:"dark"})})]}),(0,o.jsxs)(nI,{children:[(0,o.jsx)(nS,{children:(0,o.jsx)(nu,{modelBackend:C,turn:eZ,isFinalTurn:!0,threadId:w.current,treeRef:l,onChangeItemInView:Z,onChangeRating:s(),onDeleteNode:I,onRequestMoreCompletions:N,onRequestCompletion:P,onUpdateNode:M,onSandboxLinkClick:R,activeRequests:k,inlineFeedbackDisplay:!0,onHandleChangeVariantFeedbackInlineComparisonRating:s()})}),(0,o.jsx)(nN,{children:(0,o.jsx)(c.m,{disabled:!e_,title:eM,onClick:function(){return eR("right")},color:"dark"})})]})]}),(0,o.jsx)("div",{className:(0,E.Z)("grid w-full"),children:(0,o.jsxs)("div",{className:(0,E.Z)("mb-2 text-right"),children:[(0,o.jsx)(c.m,{disabled:!e_,title:"Neither answer is better",color:"primary",onClick:function(){return eR("same")},className:(0,E.Z)("mr-2")}),(0,o.jsx)(c.m,{title:"Skip this step",onClick:function(){return v(void 0)}})]})})]})]})]},"RatingModal-".concat(f))}var nN=B.Z.div(nb()),nI=B.Z.div(ny()),nP=B.Z.div(nj()),nS=B.Z.div(nw()),nT=B.Z.div(nk()),nM=t(35025),nR=t(42928),n_=t(60612);function nF(e){var n=e.text,t=e.onDone,r=(0,n_.Z)(),a=(0,u.useState)(!0),i=a[0],s=a[1],l=(0,u.useState)(0),c=l[0],d=l[1],m=(0,u.useMemo)(function(){return new nq().humanTypingDelaysQuertyDistance(n)},[n]);return(0,u.useEffect)(function(){n&&i&&(s(!0),m.forEach(function(e,n){setTimeout(function(){r()&&(d(n),n===m.length-1&&(s(!1),null==t||t()))},e)}))},[m,r,i,t,n]),(0,o.jsxs)(o.Fragment,{children:[n.substring(0,c+1),i&&"â–‹"]})}var nq=function(){function e(){(0,nM.Z)(this,e)}var n=e.prototype;return n.qwertyDistance=function(e,n){var t,r,a,o={q:[0,0],w:[1,0],e:[2,0],r:[3,0],t:[4,0],y:[5,0],u:[6,0],i:[7,0],o:[8,0],p:[9,0],a:[0,1],s:[1,1],d:[2,1],f:[3,1],g:[4,1],h:[5,1],j:[6,1],k:[7,1],l:[8,1],z:[0,2],x:[1,2],c:[2,2],v:[3,2],b:[4,2],n:[5,2],m:[6,2]},i=(0,nR.Z)(null!==(t=o[e.toLowerCase()])&&void 0!==t?t:[0,0],2),s=i[0],l=i[1],u=(0,nR.Z)(null!==(r=o[n.toLowerCase()])&&void 0!==r?r:[0,0],2);return Math.abs(s-u[0])+Math.abs(l-u[1])},n.humanTypingDelaysQuertyDistance=function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=0,a=[],o=0;o<e.length;++o){var i=void 0;if(o>0){var s=this.qwertyDistance(e[o-1],e[o]);i=0===s?this.getRandomInt(n,Math.floor(t/2)):1===s?this.getRandomInt(n,Math.floor(2*t/3)):this.getRandomInt(n,t)}else i=this.getRandomInt(n,t);a.push(i+r),r+=i}return a},n.getRandomInt=function(e,n){return Math.floor(Math.random()*(n-e+1))+e},e}(),nD=t(1744);function nE(){var e=(0,R.Z)(["flex flex-col gap-2 text-gray-100 text-sm\n",""]);return nE=function(){return e},e}function nL(){var e=(0,R.Z)(["flex py-3 px-3 items-center gap-3 relative rounded-md hover:bg-[#2A2B32] cursor-pointer break-all\n","\n"]);return nL=function(){return e},e}function nU(){var e=(0,R.Z)(["flex py-3 px-3 items-center gap-3 relative rounded-md hover:bg-[#2A2B32] cursor-pointer hover:pr-14 break-all\n","\n"]);return nU=function(){return e},e}function nA(){var e=(0,R.Z)(["text-sm border-none bg-transparent p-0 m-0 w-full"]);return nA=function(){return e},e}function nO(){var e=(0,R.Z)(["flex-1 text-ellipsis max-h-5 overflow-hidden break-all relative "]);return nO=function(){return e},e}function nz(){var e=(0,R.Z)(["absolute inset-y-0 right-0 w-8 z-10 bg-gradient-to-l\n",""]);return nz=function(){return e},e}function nB(){var e=(0,R.Z)(["absolute flex right-1 z-10 text-gray-300\n",""]);return nB=function(){return e},e}function nV(){var e=(0,R.Z)(["p-1 hover:text-white"]);return nV=function(){return e},e}var n$=J.href;function nH(e){var n=e.items,t=e.activeId,r=e.onNextPage,a=e.hasNextPage,i=e.onNewThread,s=e.onRefetchHistory,l=e.onUpdateUserModifiedTitle,c=e.userModifiedTitle,d=e.newChatName,m=e.isLoading,f=e.isError,h=(0,u.useRef)(null),g=(0,u.useState)(!1),p=g[0],v=g[1],x=(0,u.useCallback)(function(){v(!0),s()},[s]),b=0===n.length;return(0,u.useEffect)(function(){h.current&&h.current.scrollIntoView()},[]),(0,o.jsxs)(nG,{$centered:m||f&&b,children:[b&&!m&&!f&&(0,o.jsx)("div",{className:"p-3 text-center italic text-gray-500",children:"History is temporarily unavailable. We're working to restore this feature as soon as possible."}),b&&m&&(0,o.jsx)(nD.Z,{className:"m-auto"}),b&&f&&(0,o.jsxs)("div",{className:"p-3 italic text-gray-500",children:["Unable to load history",!p&&(0,o.jsx)(ee.z,{as:"button",color:"dark",size:"small",className:"m-auto mt-2",onClick:x,children:"Retry"})]}),n.map(function(e){var n=t===e.id;return(0,o.jsx)(nW,{id:e.id,title:e.title,newChatName:n?d:void 0,userModifiedTitle:n?c:"",onUpdateUserModifiedTitle:l,active:n,forwardRef:n?h:void 0,onNewThread:i,onRefetchHistory:s},"Entry-".concat(e.id))}),a&&(0,o.jsx)(ee.z,{as:"button",onClick:r,color:"dark",className:"m-auto mb-2",size:"small",children:"Show more"})]})}var nG=B.Z.div(nE(),function(e){return e.$centered&&"h-full justify-center items-center"});function nW(e){var n=e.id,t=e.title,r=e.active,a=e.onNewThread,i=e.onRefetchHistory,c=e.onUpdateUserModifiedTitle,f=e.newChatName,h=e.userModifiedTitle,g=e.forwardRef,p=(0,Y.lj)(),v=(0,d.WS)(),x=(0,l.useRouter)(),b=(0,u.useState)(!1),y=b[0],w=b[1],k=(0,u.useRef)(null),C=(0,u.useState)(!1),Z=C[0],N=C[1],I=(0,u.useState)(),P=I[0],S=I[1],T=(0,u.useCallback)(function(e){var r,a;if(null==e||e.preventDefault(),w(!1),(null===(r=k.current)||void 0===r?void 0:r.value)&&(null===(a=k.current)||void 0===a?void 0:a.value)!==t){var o=k.current.value;G.ZP.patchConversation(n,{title:o}),c(o),v(m.s6.renameThread,{threadId:n,content:o}),i()}},[v,n,i,c,t]),M=(0,u.useCallback)(function(e){"Enter"===e.key&&T()},[T]),R=(0,u.useCallback)(function(){G.ZP.patchConversation(n,{is_visible:!1}).then(function(){i()}),x.asPath===n$?a():x.replace({pathname:n$})},[n,a,i,x]),_=(0,u.useCallback)(function(e){e.preventDefault(),v(m.s6.loadThread,{threadId:n}),x.push({pathname:x.pathname,query:{chatId:n}},void 0,{shallow:!0})},[v,n,x]),F=h||r&&f||t;if((0,u.useEffect)(function(){r&&f&&f!==P&&S(f)},[r,f,F,P,h]),y)return(0,o.jsxs)(nY,{$active:r,children:[(0,o.jsx)(j.ZP,{icon:z.IC0,className:"flex-shrink-0"}),(0,o.jsx)(nX,{ref:k,type:"text",defaultValue:F,autoFocus:!0,onKeyDown:M,className:"mr-0",onBlur:T}),(0,o.jsxs)(n0,{$active:!0,children:[(0,o.jsx)(n1,{onClick:T,children:(0,o.jsx)(j.ZP,{icon:z.UgA})}),(0,o.jsx)(n1,{onClick:function(e){e.preventDefault(),w(!1)},children:(0,o.jsx)(j.ZP,{icon:z.q5L})})]})]});var q=P&&r&&!p&&!h,D='Delete "'.concat(F,'"?');return(0,o.jsxs)(nJ,{onClick:r?s():_,$active:r,className:(0,E.Z)("group",q&&"animate-flash"),ref:g,children:[(0,o.jsx)(j.ZP,{icon:Z?z.Ybf:z.IC0}),(0,o.jsxs)(nQ,{children:[q?(0,o.jsx)(nF,{text:F,onDone:i}):Z?D:F,(!P||!r)&&(0,o.jsx)(nK,{$active:r})]}),Z&&(0,o.jsxs)(n0,{$active:!0,children:[(0,o.jsx)(n1,{onClick:R,children:(0,o.jsx)(j.ZP,{icon:z.UgA})}),(0,o.jsx)(n1,{onClick:function(){N(!1)},children:(0,o.jsx)(j.ZP,{icon:z.q5L})})]}),r&&!Z&&(0,o.jsxs)(n0,{$active:r,children:[(0,o.jsx)(n1,{onClick:function(e){e.preventDefault(),w(!0)},children:(0,o.jsx)(j.ZP,{icon:z.Nte})}),(0,o.jsx)(n1,{onClick:function(){return N(!0)},children:(0,o.jsx)(j.ZP,{icon:z.Ybf})})]})]})}var nJ=B.Z.a(nL(),function(e){return e.$active?"pr-14 bg-gray-800 hover:bg-gray-800":"hover:pr-4"}),nY=B.Z.div(nU(),function(e){return e.$active&&"pr-14 bg-gray-800 hover:bg-gray-800"}),nX=B.Z.input(nA()),nQ=B.Z.div(nO()),nK=B.Z.div(nz(),function(e){return e.$active?"from-gray-800":"from-gray-900 group-hover:from-[#2A2B32]"}),n0=B.Z.div(nB(),function(e){return e.$active?"visible":"invisible group-hover:visible"}),n1=B.Z.button(nV()),n2=t(40638),n3=t(29634),n4=t(15762),n6=t(54721),n5=t.n(n6);function n7(){var e=(0,R.Z)(["flex py-3 px-3 items-center gap-3 rounded-md hover:bg-gray-500/10 transition-colors duration-200 text-white cursor-pointer text-sm"]);return n7=function(){return e},e}function n8(){var e=(0,R.Z)(["flex-col flex-1 overflow-y-auto border-b border-white/20\n",""]);return n8=function(){return e},e}var n9=B.Z.a(n7()),te=B.Z.div(n8(),function(e){return e.$offsetScrollbar&&"-mr-2"}),tn=J.href;function tt(e){var n=e.onClickAccountPayment,t=e.showAccountPaymentMenuItem,r=e.onClickCustomerPortal,a=e.showCustomerPortalMenuItem,i=e.onDeleteHistory,s=e.showDeleteHistory,c=e.onNewThread,f=e.onOpenDebugPanel,g=e.settings,p=e.children,v=(0,d.WS)(),x=(0,n4.F)(),b=x.theme,y=x.setTheme,w=(0,n_.Z)(),k=(0,h.hz)(),C=(0,l.useRouter)(),Z=(0,u.useRef)(null),N=(0,u.useState)(!1),I=N[0],P=N[1],S=(0,u.useState)(!1),T=S[0],M=S[1],R=(0,u.useMemo)(function(){var e;return(null===(e=C.query.chatId)||void 0===e?void 0:e[0])?(0,o.jsx)(n5(),{href:tn,children:(0,o.jsxs)(n9,{className:"mb-2 flex-shrink-0 border border-white/20",children:[(0,o.jsx)(j.ZP,{icon:z.OvN}),"New chat"]})},"Page-reset"):(0,o.jsxs)(n9,{onClick:c,className:"mb-2 flex-shrink-0 border border-white/20",children:[(0,o.jsx)(j.ZP,{icon:z.OvN}),"New chat"]})},[c,C.query.chatId]),_=(0,u.useCallback)(function(){v(m.s6.clickFaqLink)},[v]);(0,u.useEffect)(function(){if(Z.current){var e;P((e=Z.current).scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}},[p]);var F=(0,W.g)(function(e){return e.flags.highlightPlusUpgrade})&&!k.has("disable_upgrade_ui"),q=(0,u.useCallback)(function(){M(!1),i()},[i]);return(0,o.jsx)("div",{className:"scrollbar-trigger flex h-full w-full flex-1 items-start border-white/20",children:(0,o.jsxs)("nav",{className:"flex h-full flex-1 flex-col space-y-1 p-2",children:[R,(0,o.jsx)(te,{ref:Z,$offsetScrollbar:I,children:p}),s&&(0,o.jsxs)(n9,{onClick:function(){return T?q():M(!0)},children:[(0,o.jsx)(j.ZP,{icon:T?z.UgA:z.Ybf}),T?"Confirm clear conversations":"Clear conversations"]}),k.has("debug")&&(0,o.jsxs)(n9,{onClick:function(){return f(!0)},children:[(0,o.jsx)(j.ZP,{icon:z.cDN}),"Debug"]}),t&&n&&(0,o.jsx)(n9,{onClick:n,children:(0,o.jsxs)("span",{className:"flex w-full flex-row justify-between",children:[(0,o.jsxs)("span",{className:"gold-new-button flex items-center gap-3",children:[(0,o.jsx)(j.ZP,{icon:z.fzv}),"Upgrade to Plus"]}),F&&(0,o.jsx)("span",{className:"rounded-md bg-yellow-200 py-0.5 px-1.5 text-xs font-medium uppercase text-gray-800",children:"NEW"})]})}),w()&&(0,o.jsxs)(n9,{onClick:function(){return y("dark"===b?"light":"dark")},children:[(0,o.jsx)(j.ZP,{icon:"dark"===b?z.kXG:z.wOW}),"dark"===b?"Light":"Dark"," mode"]}),a&&r&&(0,o.jsxs)(n9,{onClick:r,children:[(0,o.jsx)(j.ZP,{icon:z.fzv}),"My account"]}),(0,o.jsxs)(n9,{href:"https://help.openai.com/en/collections/3742473-chatgpt",target:"_blank",onClick:_,children:[(0,o.jsx)(j.ZP,{icon:z.AlO}),"Updates & FAQ"]}),g,(0,o.jsxs)(n9,{onClick:function(){v(m.s6.clickLogOut,{eventSource:"mouse"}),(0,V.w7)()},children:[(0,o.jsx)(j.ZP,{icon:z.xqh}),"Log out"]})]})})}var tr=function(e){var n=e.onClickAccountPayment,t=e.showAccountPaymentMenuItem,r=e.onClickCustomerPortal,a=e.showCustomerPortalMenuItem,i=e.onDeleteHistory,s=e.showDeleteHistory,l=e.onNewThread,u=e.onOpenDebugPanel,c=e.settings,d=e.children;return(0,o.jsx)("div",{className:"dark hidden bg-gray-900 md:fixed md:inset-y-0 md:flex md:w-[260px] md:flex-col",children:(0,o.jsx)("div",{className:"flex h-full min-h-0 flex-col ",children:(0,o.jsx)(tt,{onClickAccountPayment:n,showAccountPaymentMenuItem:t,onClickCustomerPortal:r,showCustomerPortalMenuItem:a,onDeleteHistory:i,showDeleteHistory:s,onNewThread:l,onOpenDebugPanel:u,settings:c,children:d})})})},ta=function(e){var n=e.onClickAccountPayment,t=e.showAccountPaymentMenuItem,r=e.onClickCustomerPortal,a=e.showCustomerPortalMenuItem,i=e.onDeleteHistory,s=e.onSidebarOpen,l=e.sidebarOpen,c=e.showDeleteHistory,d=e.onNewThread,m=e.onOpenDebugPanel,f=e.children,h=e.settings;return(0,o.jsx)(n2.u.Root,{show:l,as:u.Fragment,children:(0,o.jsxs)(n3.V,{as:"div",className:"relative z-40 md:hidden",onClose:s,children:[(0,o.jsx)(n2.u.Child,{as:u.Fragment,enter:"transition-opacity ease-linear duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transition-opacity ease-linear duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75"})}),(0,o.jsxs)("div",{className:"fixed inset-0 z-40 flex",children:[(0,o.jsx)(n2.u.Child,{as:u.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"-translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"-translate-x-full",children:(0,o.jsxs)(n3.V.Panel,{className:"relative flex w-full max-w-xs flex-1 flex-col bg-gray-900",children:[(0,o.jsx)(n2.u.Child,{as:u.Fragment,enter:"ease-in-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in-out duration-300",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:(0,o.jsxs)("button",{type:"button",className:"ml-1 flex h-10 w-10 items-center justify-center focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:function(){return s(!1)},children:[(0,o.jsx)("span",{className:"sr-only",children:"Close sidebar"}),(0,o.jsx)(j.ZP,{icon:z.q5L,size:"medium",className:"text-white","aria-hidden":"true"})]})})}),(0,o.jsx)(tt,{onClickAccountPayment:n,showAccountPaymentMenuItem:t,onClickCustomerPortal:r,showCustomerPortalMenuItem:a,onDeleteHistory:i,showDeleteHistory:c,onNewThread:d,onOpenDebugPanel:m,settings:h,children:f})]})}),(0,o.jsx)("div",{className:"w-14 flex-shrink-0"})]})]})})},to=function(e){var n=e.onSidebarOpen,t=e.onNewThread,r=e.title,a=e.newChatName,i=(0,u.useState)(),s=i[0],c=i[1],d=(0,l.useRouter)(),m=(0,u.useMemo)(function(){var e;return(null===(e=d.query.chatId)||void 0===e?void 0:e[0])?(0,o.jsx)(n5(),{href:tn,children:(0,o.jsx)("button",{type:"button",className:"px-3",children:(0,o.jsx)(j.ZP,{icon:z.OvN,size:"medium"})})},"Page-reset"):(0,o.jsx)("button",{type:"button",className:"px-3",onClick:t,children:(0,o.jsx)(j.ZP,{icon:z.OvN,size:"medium"})})},[t,d.query.chatId]);return(0,u.useEffect)(function(){a!==s&&c(a)},[a,s]),(0,o.jsxs)("div",{className:"sticky top-0 z-10 flex items-center border-b border-white/20 bg-gray-800 pl-1 pt-1 text-gray-200 sm:pl-3 md:hidden",children:[(0,o.jsxs)("button",{type:"button",className:"-ml-0.5 -mt-0.5 inline-flex h-10 w-10 items-center justify-center rounded-md hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white dark:hover:text-white",onClick:function(){return n(!0)},children:[(0,o.jsx)("span",{className:"sr-only",children:"Open sidebar"}),(0,o.jsx)(j.ZP,{icon:z.cur,"aria-hidden":"true",size:"medium"})]}),(0,o.jsx)("h1",{className:"flex-1 text-center text-base font-normal",children:s&&a?(0,o.jsx)(nF,{text:a}):r||"New chat"}),m]})},ti=t(500);function ts(){var e=(0,R.Z)(["flex flex-row gap-2 mb-4"]);return ts=function(){return e},e}function tl(){var e=(0,R.Z)(["bg-gray-200 rounded-md text-gray-500 text-xs flex flex-row items-center gap-1 px-2 py-1"]);return tl=function(){return e},e}function tu(){var e=(0,R.Z)(["flex items-center gap-1"]);return tu=function(){return e},e}function tc(){var e=(0,R.Z)([""]);return tc=function(){return e},e}var td=function(e){var n=e.urls,t=e.onRemoveUrl,r=e.clickable,a=e.className;return 0===n.size?null:(0,o.jsx)(tm,{className:a,children:Array.from(n).map(function(e){return(0,o.jsxs)(tf,{children:[(0,o.jsx)(z.XKb,{}),(0,o.jsxs)(th,(0,T.Z)((0,S.Z)({},r?{href:e,target:"_blank",disabled:!1}:{disabled:!0}),{children:[new URL(e).hostname,r&&(0,o.jsx)(z.AlO,{})]})),t&&(0,o.jsx)(tg,{onClick:function(){return t(e)},children:(0,o.jsx)(z.q5L,{})})]},e)})})},tm=B.Z.div(ts()),tf=B.Z.div(tl()),th=B.Z.a(tu()),tg=B.Z.button(tc()),tp=u.memo(td);function tv(){var e=(0,R.Z)(["\nflex flex-col w-full py-2 flex-grow md:py-3 md:pl-4 relative border border-black/10 bg-white dark:border-gray-900/50 dark:text-white dark:bg-gray-700 rounded-md shadow-[0_0_10px_rgba(0,0,0,0.10)] dark:shadow-[0_0_15px_rgba(0,0,0,0.10)]\n","\n"]);return tv=function(){return e},e}function tx(){var e=(0,R.Z)(["\nabsolute p-1 rounded-md text-gray-500 bottom-1.5 md:bottom-2.5  hover:bg-gray-100 dark:hover:text-gray-400 dark:hover:bg-gray-900 disabled:hover:bg-transparent dark:disabled:hover:bg-transparent\n"," ",""]);return tx=function(){return e},e}function tb(){var e=(0,R.Z)(["flex ml-1 md:w-full md:m-auto md:mb-2 gap-0 md:gap-2 justify-center"]);return tb=function(){return e},e}var ty=er()(t.e(949).then(t.bind(t,93949)),{loadableGenerated:{webpack:function(){return[93949]}},ssr:!1});function tj(e){var n=e.onAbortCompletion,t=e.onCreateNewCompletion,r=e.onUpdateArtifactStatus,a=e.onRequestMoreCompletions,i=e.onContinueGenerating,s=e.onFileUpload,l=e.canUpload,c=e.artifact,f=e.currentLeafId,h=e.currentRequestId,g=e.modelBackend,p=e.threadId,v=e.isCompletionInProgress,x=e.className,b=e.placeholder,y=e.currentPrompt,w=e.onChangeCurrentPrompt,k=e.treeRef,C=e.clearOnSubmit,Z=void 0===C||C,N=e.disabled,P=void 0!==N&&N,M=e.shouldRetry,R=e.canPause,_=void 0!==R&&R,q=e.canContinue,D=void 0!==q&&q,L="root"===f,U=(0,Y.lj)(),A=(0,d.WS)(),O=(0,u.useContext)(ti.g).serviceStatus,B=(0,u.useMemo)(function(){return new Set([])},[]),V=(0,u.useRef)(null),$=(0,u.useState)(""),H=$[0],G=$[1],W=(0,u.useCallback)(function(e){r({state:"pasted",url:e,id:e,contents:""}),G("")},[r]),J=(0,u.useCallback)(function(e){w(e.currentTarget.value)},[w]),X=(0,u.useCallback)(function(e){if(null==e||e.preventDefault(),!P){var n,a,o=null===(n=V.current)||void 0===n?void 0:n.value,i="".concat(null===(a=V.current)||void 0===a?void 0:a.dataset.id,"-nextPrompt");if(o||(null==c?void 0:c.url)){var s=(null==c?void 0:c.url)||"";(null==c?void 0:c.state)==="pasted"&&r(function(e){return(0,T.Z)((0,S.Z)({},e),{state:"static"})});var l=(null==c?void 0:c.state)==="pasted"?{artifacts:[null==c?void 0:c.url]}:{};t(i,(0,S.Z)({value:o||""},l),{eventSource:e?"mouse":"keyboard"},s),Z&&w(""),G(""),(0,K.SI)(1,V.current)}}},[null==c?void 0:c.state,null==c?void 0:c.url,Z,P,t,r,w,]),Q=(0,u.useCallback)((0,I.Z)(function(){var e,n,t,r;return(0,F.__generator)(this,function(a){switch(a.label){case 0:if(!B.has("link")||"root"!==f)return[2];return[4,navigator.clipboard.readText()];case 1:return n=a.sent(),t=/^https?:\/\/[^\s]+/g,(r=null===(e=n.match(t))||void 0===e?void 0:e[0])&&G(r),[2]}})}),[B,f]),en=(0,u.useCallback)(function(){r(null)},[r]),et=(0,u.useCallback)(function(){n("",h),a(f,{eventSource:"mouse"})},[f,h,n,a,]),er=(0,u.useCallback)(function(){n("",h),A(m.s6.pauseCompletion,{threadId:p,eventSource:"mouse"})},[h,p,A,n]),ea=(0,u.useMemo)(function(){return{Enter:{validator:function(){return!P},handler:function(e){U||e.shiftKey||e.isComposing||(e.preventDefault(),v||X())}},Escape:{validator:function(){return _&&v},handler:function(){n("",h),A(m.s6.pauseCompletion,{threadId:p,eventSource:"keyboard"})}}}},[P,U,v,X,_,n,h,A,p,]);(0,u.useEffect)(function(){var e=V.current,n=function(e){var n;(null===(n=ea[e.key])||void 0===n?void 0:n.validator(e))&&ea[e.key].handler(e)};return e&&e.addEventListener("keydown",n),function(){e&&e.removeEventListener("keydown",n)}},[ea]),(0,u.useEffect)(function(){var e=V.current,n=function(n){!(null==e?void 0:e.value)&&H&&L&&(n.preventDefault(),W(H))};return B.has("link")&&e&&L&&e.addEventListener("paste",n),function(){e&&e.removeEventListener("paste",n)}},[W,f,L,r,H,B,]),(0,u.useEffect)(function(){return window.addEventListener("focus",Q),function(){window.removeEventListener("focus",Q)}},[Q]),(0,u.useEffect)(function(){var e;null===(e=V.current)||void 0===e||e.focus()},[]);var eo=!L&&!v&&!(null==O?void 0:O.oof),ei=(0,u.useCallback)(function(){i(f)},[f,i]),es=(0,u.useMemo)(function(){return(0,o.jsxs)(tZ,{className:(0,E.Z)(M&&"m-auto flex-col items-center"),children:[M&&(0,o.jsx)("span",{className:"mb-3 block text-xs md:mb-auto",children:"There was an error generating a response"}),eo&&(0,o.jsxs)(ee.z,{as:"button",color:M?"primary":"neutral",onClick:et,className:(0,E.Z)(M?"m-auto":"border-0 md:border"),children:[(0,o.jsx)(j.ZP,{icon:z.Qxo,size:U?"small":"xsmall"}),(!U||M)&&"Regenerate response"]}),D&&(0,o.jsxs)(ee.z,{as:"button",color:"neutral",onClick:ei,className:"border-0 md:border",children:[(0,o.jsx)(j.ZP,{icon:z.lV_,className:"-rotate-180",size:U?"small":"xsmall"}),!U&&"Continue generating"]}),_&&v&&(0,o.jsxs)(ee.z,{as:"button",color:"neutral",onClick:er,className:"border-0 md:border",children:[(0,o.jsx)(j.ZP,{icon:z.jxP,size:U?"small":"xsmall"}),!U&&"Stop generating"]})]})},[D,_,eo,er,et,ei,v,U,M,]);return(0,o.jsx)("form",{className:x,onSubmit:X,children:(0,o.jsxs)("div",{className:"relative flex h-full flex-1 md:flex-col",children:[!U&&es,!M&&(0,o.jsxs)(tk,{$disabled:M,children:[(null==c?void 0:c.state)==="pasted"&&(0,o.jsx)(tp,{urls:new Set([c.url]),onRemoveUrl:en,className:"ml-2"}),(0,o.jsx)(K.ZP,{tabIndex:0,onFocus:Q,value:y,"data-id":f,ref:V,style:{maxHeight:"200px"},rows:1,onChange:J,placeholder:b,className:(0,E.Z)("m-0 w-full resize-none border-0 bg-transparent p-0 pr-7 focus:ring-0 focus-visible:ring-0 dark:bg-transparent",l?"pl-7 md:pl-4":"pl-2 md:pl-0"),disabled:M}),l&&(0,o.jsx)(ty,{threadId:p,onFileUpload:s,currentLeafId:f,modelBackend:g,disabled:v,treeRef:k,children:function(e){return(0,o.jsx)(tC,{disabled:v||e,$onRightSide:!1,children:e?(0,o.jsx)(nD.Z,{}):(0,o.jsx)(j.ZP,{icon:z.Cje,size:"small"})})}}),(0,o.jsx)(tC,{disabled:v||M||P,$onRightSide:!0,$nudgeBottom:v,children:v?(0,o.jsx)("div",{className:"text-2xl",children:(0,o.jsx)(tw,{})}):(0,o.jsx)(j.ZP,{icon:z.LbG,size:"small",className:"mr-1"})})]}),U&&es]})})}function tw(){var e=(0,u.useState)(0),n=e[0],t=e[1];(0,u.useEffect)(function(){var e=setInterval(function(){t(function(e){return(e+1)%3})},350);return function(){return clearInterval(e)}},[]);for(var r=[],a=0;a<3;a++)r.push((0,o.jsx)("span",{className:a<=n?"":"invisible",children:"\xb7"},a));return(0,o.jsx)(o.Fragment,{children:r})}var tk=B.Z.div(tv(),function(e){return e.$disabled&&"bg-gray-100"}),tC=B.Z.button(tx(),function(e){return e.$nudgeBottom&&"disabled:bottom-0.5 md:disabled:bottom-1"},function(e){return e.$onRightSide?"right-1 md:right-2":"left-1 md:left-2"}),tZ=B.Z.div(tb()),tN=t(46275);function tI(e){var n=e.children,t=e.title,r=e.icon,a=e.sidebarOpen,i=e.onSidebarOpen;return(0,o.jsx)(n2.u.Root,{show:a,as:u.Fragment,children:(0,o.jsxs)(n3.V,{as:"div",className:"relative z-10",onClose:i,children:[(0,o.jsx)("div",{className:"fixed inset-0"}),(0,o.jsx)("div",{className:"fixed inset-0 overflow-hidden",children:(0,o.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:(0,o.jsx)("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:(0,o.jsx)(n2.u.Child,{as:u.Fragment,enter:"transform transition ease-in-out duration-100 sm:duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-300 sm:duration-500",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,o.jsx)(n3.V.Panel,{className:"pointer-events-auto w-screen max-w-md border-l border-gray-100 dark:border-gray-700",children:(0,o.jsxs)("div",{className:"flex h-full flex-col overflow-y-auto bg-white shadow-xl dark:bg-gray-800",children:[(0,o.jsx)("div",{className:"",children:(0,o.jsxs)("div",{className:"flex items-start justify-between",children:[(0,o.jsxs)(n3.V.Title,{className:"flex items-center gap-2 px-4 py-2 text-lg font-medium text-gray-900 dark:text-white",children:[(0,o.jsx)(j.ZP,{icon:r}),t]}),(0,o.jsx)("div",{className:"mr-2 mt-2 flex h-7 items-center",children:(0,o.jsxs)("button",{type:"button",className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",onClick:function(){return i(!1)},children:[(0,o.jsx)("span",{className:"sr-only",children:"Close panel"}),(0,o.jsx)(j.ZP,{icon:z.q5L,size:"medium","aria-hidden":"true"})]})})]})}),(0,o.jsx)("div",{className:"relative flex-1",children:n})]})})})})})})]})})}var tP=t(1215);function tS(){var e=(0,R.Z)(["bg-yellow-200 text-yellow-900 py-0.5 px-1.5 text-xs md:text-sm rounded-md uppercase"]);return tS=function(){return e},e}var tT=B.Z.span(tS()),tM=t(36284),tR=t(87762),t_={textarea:"","model-switcher":""};function tF(){var e=(0,h.hz)(),n=eH((0,w.CS)(function(e){return e.isoDate})),t=(0,tR.a)(["modelMessageCap"],function(){return G.ZP.getModelMessageCap()},{enabled:e.has("model_preview")}),r=t.data;return t.isSuccess,t.isLoading,(0,u.useMemo)(function(){var e=(null==r?void 0:r.message_cap)||0,t=(null==r?void 0:r.message_cap_window)||1,a=function(e){if(e<60)return e<2?"minute":"".concat(e," minutes");var n=Math.floor(e/60);if(n<24)return n<2?"hour":"".concat(n," hours");var t=Math.floor(n/24);if(t<7)return t<2?"day":"".concat(t," days")}(t),o=(null==r?void 0:r.message_disclaimer)||t_;return a?r&&t&&e?{textareaDisclaimer:o.textarea.replaceAll("%FORMATTED_TIME%",n).replaceAll("%NUMERATOR%","".concat(e)).replaceAll("%DENOMINATOR%",a),modelSwitcherDisclaimer:o["model-switcher"].replaceAll("%FORMATTED_TIME%",n).replaceAll("%NUMERATOR%","".concat(e)).replaceAll("%DENOMINATOR%",a)}:{textareaDisclaimer:t_.textarea,modelSwitcherDisclaimer:t_["model-switcher"]}:{textareaDisclaimer:o.textarea,modelSwitcherDisclaimer:o["model-switcher"]}},[r,n])}var tq=er()(function(){return Promise.all([t.e(904),t.e(977)]).then(t.bind(t,30545))},{loadableGenerated:{webpack:function(){return[30545]}},ssr:!1});function tD(e){var n,t=e.onChangeModelSetting,r=e.availableModels,a=e.modelBackend,i=(0,h.hz)(),s=(0,u.useMemo)(function(){return r.find(function(e){return e.id===a})},[r,a]);return(0,o.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,o.jsx)(tE,{onChangeModelSetting:t,availableModels:r,modelBackend:a}),i.has("tools3")&&(null==s?void 0:null===(n=s.enabledTools)||void 0===n?void 0:n.includes("tools3"))&&(0,o.jsx)(tq,{})]})}function tE(e){var n=e.onChangeModelSetting,t=e.availableModels,r=e.modelBackend,a=(0,w.BT)(),i=(0,d.WS)(),s=tF(),l=(0,u.useCallback)(function(e){e.id!==a&&(n(w.G3.Model,e.id),i(m.s6.toggleModel,{model:e.id}))},[a,i,n]),c="".concat(s.modelSwitcherDisclaimer),f=t.map(function(e){return{value:e,title:e.title,description:e.id===a?c:e.description,tags:e.tags,disabled:e.id===a}}),h=f.find(function(e){return e.value.id===r})||f[0];return(0,o.jsx)(tM.ZP,{name:"Model",selectedOption:h,options:f,onChange:l})}var tL=function(e){var n,t=e.modelBackend,r=e.availableModels,a=r.find(function(e){return e.id===t})||r[0],i=a.tags.filter(function(e){return tM.D2.includes(e)}).map(function(e){return(0,tM.Vp)(e)}),s=(0,eE.Z)();if(s.length>0){var l=s.map(function(e,n){return(0,o.jsx)(ej.Z,{url:e.manifest.logo_url,name:e.manifest.name_for_human,size:16},n)});n=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{children:"Enabled plugins:"}),l]})}return(0,o.jsxs)("div",{className:"flex w-full items-center justify-center gap-1 border-b border-black/10 bg-gray-50 p-3 text-gray-500 dark:border-gray-900/50 dark:bg-gray-700 dark:text-gray-300",children:["Model: ",a.title,i,n?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"px-1",children:"â€¢"}),n]}):null]})},tU=t(75318);function tA(){var e=(0,R.Z)(["text-gray-800 w-full md:max-w-2xl lg:max-w-3xl md:h-full md:flex md:flex-col px-6 dark:text-gray-100"]);return tA=function(){return e},e}function tO(){var e=(0,R.Z)(["text-4xl font-semibold text-center mt-6 sm:mt-[20vh] ml-auto mr-auto mb-10 sm:mb-16 flex gap-2 items-center justify-center"]);return tO=function(){return e},e}function tz(){var e=(0,R.Z)(["md:flex items-start text-center gap-3.5"]);return tz=function(){return e},e}function tB(){var e=(0,R.Z)(["flex flex-col mb-8 md:mb-auto gap-3.5 flex-1"]);return tB=function(){return e},e}function tV(){var e=(0,R.Z)(["flex gap-3 items-center m-auto text-lg font-normal md:flex-col md:gap-2"]);return tV=function(){return e},e}function t$(){var e=(0,R.Z)(["flex flex-col gap-3.5 w-full sm:max-w-md m-auto"]);return t$=function(){return e},e}function tH(){var e=(0,R.Z)(["w-full bg-gray-50 dark:bg-white/5 p-3 rounded-md"]);return tH=function(){return e},e}function tG(){var e=(0,R.Z)(["w-full bg-gray-50 dark:bg-white/5 p-3 rounded-md after:content-['\"'] before:content-['\"']"]);return tG=function(){return e},e}function tW(){var e=(0,R.Z)(["w-full bg-gray-50 dark:bg-white/5 p-3 rounded-md hover:bg-gray-200 dark:hover:bg-gray-900"]);return tW=function(){return e},e}var tJ=B.Z.div(tA()),tY=B.Z.h1(tO()),tX=B.Z.div(tz()),tQ=B.Z.div(tB()),tK=B.Z.h2(tV()),t0=B.Z.ul(t$()),t1=B.Z.li(tH());B.Z.li(tG());var t2=B.Z.button(tW());function t3(e){var n=e.text,t=e.onChangeCurrentPrompt,r=(0,u.useCallback)(function(){t(n)},[n,t]);return(0,o.jsxs)(t2,{onClick:r,children:['"',n,'" â†’']})}function t4(e){var n=e.onChangeCurrentPrompt,t=(0,h.nR)();return(0,o.jsxs)(tJ,{children:[(0,o.jsxs)(tY,{children:["ChatGPT",t&&(0,o.jsx)(tT,{children:"Plus"})]}),(0,o.jsxs)(tX,{children:[(0,o.jsxs)(tQ,{children:[(0,o.jsxs)(tK,{children:[(0,o.jsx)(j.ZP,{icon:z.kXG,size:"medium"}),"Examples"]}),(0,o.jsxs)(t0,{children:[(0,o.jsx)(t3,{text:"Explain quantum computing in simple terms",onChangeCurrentPrompt:n}),(0,o.jsx)(t3,{text:"Got any creative ideas for a 10 year oldâ€™s birthday?",onChangeCurrentPrompt:n}),(0,o.jsx)(t3,{text:"How do I make an HTTP request in Javascript?",onChangeCurrentPrompt:n})]})]}),(0,o.jsxs)(tQ,{children:[(0,o.jsxs)(tK,{children:[(0,o.jsx)(j.ZP,{icon:tU.Z,size:"medium"}),"Capabilities"]}),(0,o.jsxs)(t0,{children:[(0,o.jsx)(t1,{children:"Remembers what user said earlier in the conversation"}),(0,o.jsx)(t1,{children:"Allows user to provide follow-up corrections"}),(0,o.jsx)(t1,{children:"Trained to decline inappropriate requests"})]})]}),(0,o.jsxs)(tQ,{children:[(0,o.jsxs)(tK,{children:[(0,o.jsx)(j.ZP,{icon:z.BJv,size:"medium"}),"Limitations"]}),(0,o.jsxs)(t0,{children:[(0,o.jsx)(t1,{children:"May occasionally generate incorrect information"}),(0,o.jsx)(t1,{children:"May occasionally produce harmful instructions or biased content"}),(0,o.jsx)(t1,{children:"Limited knowledge of world and events after 2021"})]})]})]})]})}function t6(){var e=(0,R.Z)(["flex flex-col items-center text-sm  dark:bg-gray-800"]);return t6=function(){return e},e}function t5(){var e=(0,R.Z)(["w-full h-32 md:h-48 flex-shrink-0"]);return t5=function(){return e},e}function t7(){var e=(0,R.Z)(["cursor-pointer absolute right-6 bottom-[124px] md:bottom-[120px] z-10 rounded-full border border-gray-200 bg-gray-50 text-gray-600 dark:border-white/10 dark:bg-white/10 dark:text-gray-200"]);return t7=function(){return e},e}function t8(){var e=(0,R.Z)(["px-2 py-10 relative w-full flex flex-col h-full"]);return t8=function(){return e},e}function t9(){var e=(0,R.Z)(["text-4xl font-semibold text-center text-gray-200 dark:text-gray-600 ml-auto mr-auto mb-10 sm:mb-16 flex gap-2 items-center justify-center flex-grow"]);return t9=function(){return e},e}function re(e){var n=e.conversationTurns,t=e.onChangeItemInView,r=e.onRequestMoreCompletions,a=e.onUpdateNode,i=e.onChangeRating,s=e.onDeleteNode,l=e.onRequestCompletion,c=e.onChangeCurrentPrompt,d=e.onSandboxLinkClick,m=e.onHandleChangeVariantFeedbackInlineComparisonRating,f=e.threadId,g=e.treeRef,p=e.activeRequests,v=e.isProcessingArtifact,x=e.isLoading,b=e.onChangeModelSetting,y=e.availableModels,k=e.currentThreadModel,C=e.canShowThreadSettings,Z=(0,tP.useScrollToBottom)(),N=(0,nR.Z)((0,tP.useSticky)(),1)[0],I=(0,n_.Z)(),P=n.length<2,S=C&&P&&!x,T=(0,h.nR)(),M=(0,u.useState)(!1),R=M[0],_=M[1],F=(0,w.ZP)(y,k,f).modelBackend;return(0,u.useEffect)(function(){x?setTimeout(function(){I()&&_(!0)},1e3):_(!1)},[x,I]),(0,o.jsxs)(o.Fragment,{children:[S&&(0,o.jsxs)(ra,{children:[(0,o.jsx)(tD,{onChangeModelSetting:b,availableModels:y,modelBackend:F}),(0,o.jsxs)(ro,{children:["ChatGPT",T&&(0,o.jsx)(tT,{children:"Plus"})]})]}),(0,o.jsxs)(rn,{children:[P&&!x&&!C&&(0,o.jsx)(t4,{onChangeCurrentPrompt:c}),R&&x&&(0,o.jsx)(nD.Z,{className:"mx-auto mt-4"}),!P&&!x&&C&&(0,o.jsx)(tL,{availableModels:y,modelBackend:F}),n.map(function(e,u){return e.role===H.uU.Unknown||e.role===H.uU.System?null:(0,o.jsx)(nu,{turn:e,isFinalTurn:u===n.length-1,threadId:f,treeRef:g,onChangeItemInView:t,onChangeRating:i,onRequestMoreCompletions:r,onDeleteNode:s,onRequestCompletion:l,onUpdateNode:a,onSandboxLinkClick:d,onHandleChangeVariantFeedbackInlineComparisonRating:m,activeRequests:p,modelBackend:F},u)}),!S&&(0,o.jsx)(rt,{})]}),v&&(0,o.jsx)(nD.Z,{className:"mx-auto mt-4"}),!N&&(0,o.jsx)(rr,{onClick:Z,children:(0,o.jsx)(j.ZP,{icon:z.tv1,className:"m-1"})})]})}var rn=B.Z.div(t6()),rt=B.Z.div(t5()),rr=B.Z.button(t7()),ra=B.Z.div(t8()),ro=B.Z.h1(t9()),ri=er()(function(){return Promise.resolve().then(t.bind(t,1215))},{loadableGenerated:{webpack:function(){return[1215]}},ssr:!1});function rs(e){var n=e.children;return(0,o.jsx)(ri,{className:(0,E.Z)("h-full dark:bg-gray-800"),followButtonClassName:"scroll-convo",initialScrollBehavior:"auto",children:n})}var rl=t(69153);function ru(){var e=(0,R.Z)(["flex gap-4 mt-6"]);return ru=function(){return e},e}function rc(e){var n=e.onBack,t=e.onNext,r=e.onSubmit;return(0,o.jsxs)(rd,{children:[n&&(0,o.jsx)(ee.z,{as:"button",color:"neutral",onClick:n,children:"Back"}),t&&(0,o.jsx)(ee.z,{as:"button",onClick:t,color:"neutral",className:"ml-auto",children:"Next"}),r&&(0,o.jsx)(ee.z,{as:"button",onClick:r,color:"primary",className:"ml-auto",children:"Done"})]})}var rd=B.Z.div(ru());function rm(){var e=(0,R.Z)(["prose dark:prose-invert"]);return rm=function(){return e},e}function rf(){var e=(0,R.Z)(["!mt-4 font-normal !mb-2"]);return rf=function(){return e},e}function rh(){var e=(0,R.Z)(["mb-4"]);return rh=function(){return e},e}function rg(){var e=(0,R.Z)(["w-full h-[1px] bg-gray-300 opacity-20"]);return rg=function(){return e},e}var rp="oai/apps/hasSeenOnboarding",rv=J.id,rx=J.name,rb=function(){var e=(0,u.useCallback)(function(){f.m.setItem("".concat(rp,"/").concat(rv),new Date().toLocaleDateString("en-CA",{year:"numeric",month:"2-digit",day:"2-digit"}))},[]),n=(0,u.useState)(null),t=n[0],r=n[1];(0,u.useEffect)(function(){r(f.m.getItem("".concat(rp,"/").concat(rv)))},[r]);var a=(0,u.useCallback)(function(){return t?new Date(!0===t?"2022-12-14":t):t},[t]);return(0,u.useMemo)(function(){return{setHasSeenOnboarding:e,getHasSeenOnboardingDate:a}},[a,e])};function ry(e){var n=e.onClose,t=rb().setHasSeenOnboarding,r=(0,u.useState)(0),a=r[0],i=r[1],s=(0,u.useCallback)(function(){n(!0),t()},[n,t]);return(0,o.jsxs)(rZ,{children:[0===a&&(0,o.jsx)(rw,{onChangePage:i}),1===a&&(0,o.jsx)(rk,{onChangePage:i}),2===a&&(0,o.jsx)(rC,{onChangePage:i,onSubmit:s})]})}var rj=function(){return"chat"===rv?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"mb-5",children:(0,o.jsx)(rN,{children:(0,o.jsx)("b",{children:rx})})}),(0,o.jsx)(rP,{})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(rN,{children:["Welcome to ",(0,o.jsx)("b",{children:rx})]}),(0,o.jsx)("p",{children:"Here are a few things to keep in mind before we get started:"}),(0,o.jsx)(rP,{})]})},rw=function(e){var n=e.onChangePage;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(rj,{}),(0,o.jsx)(rI,{children:"This is a free research preview."}),(0,o.jsxs)(rl.I,{children:[(0,o.jsx)(rl.Z,{icon:"\uD83D\uDD2C",children:"Our goal is to get external feedback in order to improve our systems and make them safer."}),(0,o.jsx)(rl.Z,{icon:"\uD83D\uDEA8",children:"While we have safeguards in place, the system may occasionally generate incorrect or misleading information and produce offensive or biased content. It is not intended to give advice."})]}),(0,o.jsx)(rc,{onNext:function(){return n(1)}})]})},rk=function(e){var n=e.onChangePage;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(rj,{}),(0,o.jsx)(rI,{children:"How we collect data"}),(0,o.jsxs)(rl.I,{children:[(0,o.jsx)(rl.Z,{icon:"\uD83E\uDDBE",children:"Conversations may be reviewed by our AI trainers to improve our systems."}),(0,o.jsx)(rl.Z,{icon:"\uD83D\uDD10",children:"Please don't share any sensitive information in your conversations."})]}),(0,o.jsx)(rc,{onBack:function(){return n(0)},onNext:function(){return n(2)}})]})},rC=function(e){var n=e.onChangePage,t=e.onSubmit,r=(0,u.useRef)(null);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(rj,{}),(0,o.jsx)(rI,{children:"We'd love your feedback!"}),(0,o.jsxs)(rl.I,{children:[(0,o.jsx)(rl.Z,{icon:"\uD83D\uDC4D",children:"This system is optimized for dialogue. Let us know if a particular response was good or unhelpful."}),(0,o.jsxs)(rl.Z,{icon:"\uD83D\uDCAC",children:["Share your feedback in our"," ",(0,o.jsx)("a",{href:"https://discord.gg/openai",target:"_blank",rel:"noreferrer",children:"Discord server"}),"."]})]}),(0,o.jsx)(rc,{onBack:function(){return n(1)},onSubmit:function(){return null==t?void 0:t(r)}})]})},rZ=B.Z.div(rm()),rN=B.Z.h2(rf()),rI=B.Z.h4(rh()),rP=B.Z.div(rg()),rS=t(24058),rT=t(35e3),rM=t(69858),rR=t(77507);function r_(e){var n=e.isOpen,t=e.onClose,r=(0,u.useRef)(null),a=(0,d.WS)(),i=(0,u.useState)(!1),s=i[0],c=i[1],f=(0,l.useRouter)(),h=(0,u.useCallback)(function(){a(m.s6.closeAccountPaymentModal),t()},[t,a]),g=(0,u.useCallback)((0,I.Z)(function(){var e;return(0,F.__generator)(this,function(n){switch(n.label){case 0:c(!0),a(m.s6.clickAccountCustomerPortal),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,G.ZP.fetchCustomerPortalUrl()];case 2:return e=n.sent(),f.push(e.url),[3,5];case 3:return n.sent(),p.m.warning("The account management page encountered an error. Please try again. If the problem continues, please visit help.openai.com.",{hasCloseButton:!0}),[3,5];case 4:return c(!1),[7];case 5:return[2]}})}),[f,a,c]);return(0,o.jsxs)(rT.x,{isOpen:n,onClose:t,focusRef:r,children:[(0,o.jsxs)("div",{className:"flex w-full flex-row items-center justify-between border-b py-3 px-4 dark:border-gray-700",children:[(0,o.jsx)("span",{className:"text-base font-semibold sm:text-base",children:"Your Account"}),(0,o.jsx)("button",{className:"text-gray-700 opacity-50 transition hover:opacity-75 dark:text-white",onClick:h,children:(0,o.jsx)(z.q5L,{className:"h-6 w-6"})})]}),(0,o.jsx)("div",{className:"grid",children:(0,o.jsx)("div",{className:"relative order-1 col-span-1 sm:order-2",children:(0,o.jsx)(rM.Oi,{rowElements:[(0,o.jsx)(rM.Cu,{text:rR.S.plus.name,children:(0,o.jsx)("span",{className:"font-semibold text-gray-500",children:rR.S.plus.costInDollars})},"row-plus-plan-name"),(0,o.jsx)(rM.hi,{disabled:!0,variant:"primary-disabled",ref:r,text:rR.S.plus.callToAction.active},"row-plus-plan-button"),(0,o.jsx)(rM.G,{text:rR.S.plus.demandAccess},"row-plus-plan-demand"),(0,o.jsx)(rM.G,{text:rR.S.plus.responseSpeed},"row-plus-plan-speed"),(0,o.jsx)(rM.G,{className:"sm:pb-1",text:rR.S.plus.modelFeatures},"row-plus-plan-feathers"),(0,o.jsx)(rM.nR,{className:"sm:pb-1",isLoading:s,text:rR.S.manageSubscription.callToAction,onClick:g},"row-plus-plan-manage"),]})})})]})}var rF=t(86885),rq=t(59268),rD={showAccountPaymentModal:!1},rE=(0,rq.ZP)()(function(e){return(0,T.Z)((0,S.Z)({},rD),{setShowAccountPaymentModal:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s();e({showAccountPaymentModal:n}),t&&t()}})}),rL=t(35873),rU=t(77064);function rA(){var e=(0,R.Z)(["h-[37px] py-2.5 px-6 text-xs uppercase text-gray-700 font-medium border-y relative"]);return rA=function(){return e},e}function rO(){var e=(0,R.Z)(["relative py-1 px-6 text-xs uppercase text-gray-700 font-medium bg-gray-100 border-y"]);return rO=function(){return e},e}B.Z.h3(rA());var rz=B.Z.h3(rO());function rB(){var e=(0,R.Z)(["overflow-y-auto h-full"]);return rB=function(){return e},e}function rV(){var e=(0,R.Z)(["whitespace-pre-wrap text-sm"]);return rV=function(){return e},e}function r$(){var e=(0,R.Z)(["px-6 py-4 flex flex-col gap-1 hover:bg-gray-50 dark:hover:bg-gray-500/10 cursor-pointer border-b dark:border-black/10 border-gray-200"]);return r$=function(){return e},e}function rH(){var e=(0,R.Z)(["absolute top-1/2 -translate-y-1/2 right-6"]);return rH=function(){return e},e}function rG(e){var n=e.treeRef,t=e.currentLeafId,r=(0,u.useState)(),a=r[0],i=r[1],s=(0,u.useMemo)(function(){return n.current.getBranchFromLeaf(t).filter(function(e){return e.type!==H.Jq.Root}).map(function(e){return e.message})},[n,t]),l=(0,u.useCallback)(function(){i(void 0)},[]),d=(0,u.useCallback)(function(){navigator.clipboard.writeText(n.current.getTextFromThread(t))},[n,t]),m=s.map(function(e,n){var t=X.Cv.getRoleFromMessage(e),r=X.Cv.getNameFromMessage(e);return(0,o.jsxs)(rY,{role:"button",onClick:function(){return i(n)},children:[(0,o.jsxs)("div",{className:"text-xs font-medium uppercase text-gray-400",children:[t,t!==r&&" (".concat(r,")")," -> ",X.Cv.getRecipientFromMessage(e)]}),(0,o.jsx)("div",{children:X.Cv.getTextFromMessage(e)})]},e.id)});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(rW,{children:[(0,o.jsxs)(rz,{children:["Conversation messages",(0,o.jsx)(rX,{children:(0,o.jsx)(rU.$,{label:(0,o.jsx)(rU.u,{text:"Copy conversation text to clipboard"}),children:(0,o.jsx)(rL.Z,{onCopy:d})})})]}),(0,o.jsx)(rJ,{children:m})]}),void 0!==a&&(0,o.jsx)(c.Z,{isOpen:!0,onModalClose:l,type:"success",children:(0,o.jsx)("pre",{className:"max-h-[80vh] overflow-auto whitespace-pre-wrap text-xs",children:JSON.stringify(s[a],null,2)})},"DebugMessageModal-".concat(a))]})}var rW=B.Z.div(rB()),rJ=B.Z.pre(rV()),rY=B.Z.div(r$()),rX=B.Z.div(rH()),rQ=t(85087),rK=t(30331);function r0(){var e=(0,V.kP)(),n=e.session,t=e.loading,r=(0,tR.a)(["models"],function(){return G.ZP.getModels(n.accessToken)},{enabled:Boolean(!t&&(null==n?void 0:n.accessToken)),placeholderData:{models:[{slug:"text-davinci-002-render",max_tokens:4097,title:"Default",description:"",tags:[]},]},onError:function(e){try{rK.Tb(e)}catch(n){}}}).data;return(0,u.useMemo)(function(){var e;return{availableModels:r?(e=r.models).map(function(e){return{id:e.slug,maxTokens:e.max_tokens,title:e.title,description:e.description,tags:e.tags,enabledTools:e.enabled_tools,properties:e.qualitative_properties}}):[]}},[r])}var r1=t(62906);t(49674);var r2=t(44675);"".concat(r2.env.INTERNAL_API_URL,"/api");var r3=t(89678),r4=t.n(r3),r6=t(34388),r5=t(39400),r7="oai/apps/hasSeenHistoryFilteredDisclosure/".concat("2023-03-21"),r8=[/\bnigger\w*/i,/\bfaggot\w*/i,/\bkike\w*/i,/\bdykes?\b/i,/\bwetbacks?\b/i,/\bchinks?\b/i,/\bgooks?\b/i,/\bpakis?\b/i,/\binjuns?\b/i,/\btrannys?\b/i,/\btrannies\b/i,/\bspicks?\b/i,/\bshemales?\b/i,];function r9(){var e=(0,R.Z)(["overflow-hidden w-full h-full relative"]);return r9=function(){return e},e}function ae(){var e=(0,R.Z)(["relative h-full w-full transition-width flex flex-col overflow-hidden items-stretch"]);return ae=function(){return e},e}function an(){var e=(0,R.Z)(["grow flex-1 overflow-hidden"]);return an=function(){return e},e}function at(){var e=(0,R.Z)(["absolute bottom-0 left-0 w-full border-t md:border-t-0 dark:border-white/20 md:border-transparent md:dark:border-transparent md:bg-vert-light-gradient bg-white dark:bg-gray-800 md:!bg-transparent dark:md:bg-vert-dark-gradient pt-2"]);return at=function(){return e},e}var ar="oai/apps/hasSeenHistoryRestored",aa=J.href,ao=function(e){var n,r,a,i,v,x,b,y,k,C,Z,N,R,L,A,B,J,K,ee,en,et,er,ea,eo,ei,es,el,eu,ec,ed,em,ef,eh,eg,ep,ev,ex,eb,ey,ej,ew,ek,eC,eZ,eN=e.initialData,eI=e.isLoading,eP=(0,h.hz)(),eS=(0,l.useRouter)(),eT=(0,Y.lj)(),eM=(0,d.WS)(),eR=eP.has("disable_history"),e_=eP.has(g)&&!eT,eF=(a=(0,r1.NL)(),(0,u.useCallback)(function(e){a.removeQueries(["conversation",e])},[a])),eq=(0,u.useState)(),eD=eq[0],eE=eq[1],eL=(0,u.useState)(),eU=eL[0],eA=eL[1],eO=(0,u.useState)(),ez=eO[0],eB=eO[1],eV=(0,u.useRef)(null),e$=(0,u.useRef)(eN.threadId||""),eH=(0,rQ.Z)(),eG=eH.accountStatusResponse,eW=eH.isLoading,eJ=(0,h.nR)(),eY=(0,W.g)(function(e){return e.flags.isUserInCanPayGroup}),eX=(0,V.kP)().session,eQ=null==eX?void 0:eX.accessToken,eK=(v=(i={enabled:!eR&&Boolean(eQ)&&!eW,accessToken:eQ}).enabled,x=i.accessToken,b=(0,u.useRef)(Boolean(f.m.getItem(r7))),C=(k=(0,r5.N)({queryKey:["conversations"],queryFn:function(e){var n=e.pageParam;return G.ZP.getConversations(n||0,20,x)},getNextPageParam:function(e){var n=e.offset+e.limit;return n<e.total?n:void 0},enabled:v})).data,Z=k.fetchNextPage,N=k.hasNextPage,R=k.refetch,L=k.isInitialLoading,A=k.isError,(0,u.useEffect)(function(){var e,n;!A&&(null==C?void 0:null===(e=C.pages)||void 0===e?void 0:null===(n=e[0])||void 0===n?void 0:n.has_missing_conversations)&&!b.current&&p.m.warning("We've restored conversation history for all ChatGPT users and resolved the underlying issue, which was caused by a significant bug in an open-source library.\n\nIn order to ensure that this issue does not reoccur, users will not be able to retrieve their chat history from the morning of March 20th. We apologize to our users for any difficulties this may cause.",{duration:0,hasCloseButton:!0,onRemove:function(){f.m.setItem(r7,!0),b.current=!0}})},[null==C?void 0:C.pages,b,A]),(0,u.useMemo)(function(){return{conversations:null==C?void 0:C.pages.reduce(function(e,n){if(n){var t=n.items;e.push.apply(e,(0,Q.Z)(void 0===t?[]:t))}return e},[]),hasNextPage:N,fetchNextPage:Z,refetch:function(){return v&&R()},isLoading:L,isError:v&&A}},[null==C?void 0:C.pages,v,Z,N,A,L,R,])),e0=eK.conversations,e1=eK.hasNextPage,e2=eK.fetchNextPage,e3=eK.refetch,e4=eK.isLoading,e6=eK.isError,e5=(0,u.useState)(!1),e7=e5[0],e8=e5[1],e9=(J=(B={exempt:!1,onRestrictedTermFound:(0,u.useCallback)(function(e){e8(!0),eM(m.s6.promptUsedRestrictedWords,{threadId:e$.current,content:e})},[eM])}).exempt,K=B.onRestrictedTermFound,en=(ee=(0,u.useState)(!1))[0],et=ee[1],{hasRestrictedTerms:en,checkRestrictedTerms:(0,u.useCallback)(function(e){var n;return(r8.some(function(t){var r=t.exec(e);return r&&(n=r[0]),r}),!J&&n)?(et(!0),null==K||K(n),!0):(et(!1),!1)},[J,K])}),ne=e9.hasRestrictedTerms,nn=e9.checkRestrictedTerms,nt=(0,u.useState)(!0),nr=nt[0],na=nt[1],no=(0,u.useState)(!1),ni=no[0],ns=no[1],nl=(0,u.useState)(!1),nu=nl[0],nc=nl[1],nd=(0,u.useState)(!1),nm=nd[0],nf=nd[1],nh=r0().availableModels,ng=(0,rS.p0)(),np=(0,w.ZP)(nh,eN.lastModelUsed,e$.current),nv=np.temperature,nx=np.modelBackend,nb=np.onChangeModelSetting,ny=(0,u.useMemo)(function(){return nh.find(function(e){return e.id===nx})},[nh,nx]),nj=(0,u.useRef)(new X.Cv(eN.thread)),nw=(0,u.useState)(eN.currentLeafId),nk=nw[0],nN=nw[1],nI=(0,u.useState)(!1),nP=nI[0],nS=nI[1],nT=(0,u.useState)(null),nM=nT[0],nR=nT[1],n_=(0,u.useState)({}),nF=n_[0],nq=n_[1],nD=(0,u.useState)(new Set),nE=nD[0],nL=nD[1],nU=(0,u.useCallback)(function(e){nq(function(n){return n[e],(0,M.Z)(n,[e].map(_.Z))})},[]),nA=(0,u.useCallback)(function(){e3(),nB(""),nS(!1),eM(m.s6.newThread)},[eM,e3]),nO=(0,u.useState)(""),nz=nO[0],nB=nO[1],nV=(0,u.useState)(""),n$=nV[0],nG=nV[1],nW=n$||nz||eN.title,nJ=(0,u.useCallback)(function(e){G.ZP.generateTitle(e$.current,e,nx).then(function(e){var n=e.title;nB(n),eM(m.s6.renameThread,{threadId:e$.current,content:n,model:nx})}).catch(function(e){console.error(e)})},[eM,nx]),nY=(er=e$,ec=eP.has("tools3")&&(null==ny?void 0:null===(n=ny.enabledTools)||void 0===n?void 0:n.includes("tools3"))?ng.map(function(e){return e.id}):void 0,ed=(0,h.hz)(),em=(0,u.useId)(),ef=(0,d.WS)(),eh=(0,w.CS)(function(e){return null==e?void 0:e.setCapTimeout}),eg=(0,w.CS)(function(e){return null==e?void 0:e.clearCapTimeout}),ep=(0,u.useRef)(0),ev=(0,u.useRef)({}),ex=(0,u.useRef)(),(0,u.useEffect)(function(){function e(){return(e=(0,I.Z)(function(){return(0,F.__generator)(this,function(e){switch(e.label){case 0:return[4,t.e(554).then(t.bind(t,76554))];case 1:return ex.current=e.sent(),[2]}})})).apply(this,arguments)}ed.has("tools3_dev")&&function(){e.apply(this,arguments)}()},[ed]),eb=(0,u.useCallback)(function(e,n,t,r){var a,o=r.eventSource,i=function(){setTimeout(function(){nU(t),nL(function(e){var n=new Set(e);return n.delete(t),n}),delete ev.current[t]},0)},s=nj.current,l=t,u=s.getParentId(l),c="CompletionUpdated:".concat(t),d="CompletionUpdated:".concat(u),f=n===H.Os.Continue,h=!0,g=!1,p=s.getMessage(l),v=s.getIsBlockedFromNode(u),x=!1,b=!1,y=r4()(function(){v||x||(s.updateNodeMessage(l,p),O().publish(c,{nodeId:l}))},50,{leading:!0,maxWait:50});function j(e,n,t){return k.apply(this,arguments)}function k(){return(k=(0,I.Z)(function(e,n,t){var r,a,o,i,l,u=arguments;return(0,F.__generator)(this,function(f){switch(f.label){case 0:r=u.length>3&&void 0!==u[3]&&u[3],f.label=1;case 1:return f.trys.push([1,3,,4]),[4,(0,$._I)(t,!1,er.current,s.getMessageId(n))];case 2:return o=(a=f.sent()).isBlocked,i=a.isFlagged,(o||i)&&(b=!0),o?(x=!0,r||(v=!0),s.updateNode(n,{message:{content:{parts:{$set:[""]}}},metadata:{$set:(0,T.Z)((0,S.Z)({},$.sK),{completionSampleFinishTime:Date.now()})}}),O().publish(r?c:d,{nodeId:n}),ef(r?m.s6.completionBlockedByModeration:m.s6.promptBlockedByModeration,{threadId:e,id:n})):i?(s.updateNode(n,{metadata:{$set:$.Mf}}),O().publish(r?c:d,{nodeId:n}),ef(r?m.s6.completionFlaggedByModeration:m.s6.promptFlaggedByModeration,{threadId:e,id:n})):r&&v&&(s.updateNodeMessage(n,p),O().publish(c,{nodeId:n})),[3,4];case 3:return l=f.sent(),x=!0,s.updateNode(n,{metadata:{$set:{err:"An error occured",errType:"danger",completionSampleFinishTime:Date.now()}}}),ef(m.s6.moderationError,{threadId:e,content:JSON.stringify(l||"")}),O().publish(r?c:d,{nodeId:n}),O().publish("UnrecoverableError"),[3,4];case 4:return[2]}})})).apply(this,arguments)}return a=(0,I.Z)(function(r){var a,d,k,C,Z,N,I,P,M,R,_,q,D,E,L,U,A,z,B;return(0,F.__generator)(this,function(F){switch(F.label){case 0:if(a=r.err,d=r.finish_reason,k=r.message,C=r.threadId,(a||!k)&&!d)return a&&console.error(a),Z=(null==a?void 0:a.message)||"Something went wrong",s.updateNode(l,{message:{$set:p},metadata:{$set:{err:Z,errType:"danger",errCode:(0,r6.T)(a)&&a.code||"",completionSampleFinishTime:Date.now()}}}),O().publish(c,{nodeId:l}),i(),(0,r6.T)(a)&&(null==a?void 0:a.code)===w.uU&&(null==a?void 0:a.clearsIn)&&(eh(new Date(Date.now()+1e3*a.clearsIn).toISOString()),setTimeout(function(){eg()},1e3*a.clearsIn)),[2];if(h&&s.isFirstCompletion){if((null==k?void 0:null===(N=k.author)||void 0===N?void 0:N.role)===H.uU.System)return s.appendSystemMessageToRoot(k),[2];if((null==k?void 0:null===(I=k.author)||void 0===I?void 0:I.role)===H.uU.User)return[2]}if(h?(h=!1,g=s.isFirstCompletion,C&&(er.current=C),s.updateNodeMessage(l,k),g&&nA(),f||j(er.current,u,s.getTextFromLastNTurns(u,1),!1),ef(m.s6.generateCompletion,{id:t,threadId:C,completionType:n,eventSource:o,model:e}),O().publish("PublishAborter",{id:t,aborter:ev.current[t]})):k&&!f&&k.id!==s.getMessageId(l)&&(y.flush(),s.addNode(k.id,k,l,H.Jq.Completion),nN(l=k.id),c="CompletionUpdated:".concat(l)),k&&(p=k),y(),"stop"!==d||(v||x||(y.flush(),!b&&g&&nJ(s.getMessageId(l))),P=X.Cv.getTextFromMessage(p),M=s.getTextFromLastNTurns(u,2)+"\n\n"+P,j(er.current,l,M,!0),x||O().publish(c,{nodeId:l}),s.updateNode(l,{metadata:{$set:(0,T.Z)((0,S.Z)({},s.getMetadata(l)),{completionSampleFinishTime:Date.now()})}}),i(),!ed.has("tools3_dev")))return[3,3];if(R=ex.current)return[3,1];return console.error("Error loading tools3"),[3,3];case 1:if(!(_=R.getLocalhostPluginHttpApiCallData(p)))return[3,3];return[4,R.makeLocalhostPluginHttpApiCall(_)];case 2:q=F.sent(),D=l,E=!0,L=!1,U=void 0;try{for(A=q[Symbol.iterator]();!(E=(z=A.next()).done);E=!0)B=z.value,s.addNode(B.id,B,D,H.Jq.Completion,{completionSampleFinishTime:Date.now()}),D=B.id}catch(V){L=!0,U=V}finally{try{E||null==A.return||A.return()}finally{if(L)throw U}}nN(D),ej(e,H.Os.Next,D,{}),F.label=3;case 3:return[2]}})}),function(e){return a.apply(this,arguments)}},[ef,nA,nJ,nU,nL,nN,er,nj,]),ej=(0,u.useCallback)((ey=(0,I.Z)(function(e,n,t,r){var a,o,i,s,l,u,c,d,m,f=arguments;return(0,F.__generator)(this,function(h){switch(h.label){case 0:return a=!(f.length>4)||void 0===f[4]||f[4],o=nj.current,i="request-".concat(em,"-").concat(ep.current++),nL(function(e){var n=new Set(e);return n.add(i),n}),o.addNode(i,"",t,H.Jq.Completion),a&&nN(i),l=[],u=o.getNode(t),n===H.Os.Next||n===H.Os.Variant?(s=(null===(c=(d=o.getNode(u.parentId)).message)||void 0===c?void 0:c.id)||d.id,l.push(u.message)):s=u.message.id,[4,G.ZP.publicApiCompletionStream({model:e,completionType:n,threadId:er.current||void 0,parentMessageId:s,messages:l,enabledPluginIds:ec},eb(e,n,i,r))];case 1:return m=h.sent(),ev.current[i]=m,[2]}})}),function(e,n,t,r){return ey.apply(this,arguments)}),[nj,em,nL,nN,er,ec,eb,])),nX=(0,u.useCallback)(function(){eS.replace({pathname:eS.basePath,query:{}},void 0,{shallow:!0})},[eS]),nQ=(0,u.useCallback)(function(){if(nk){var e=nj.current.getBranchFromLeaf(nk);nq(function(n){var t=(0,S.Z)({},n);return e.forEach(function(e){e.id in t&&(t[e.id].abort(),delete t[e.id])}),t}),nL(function(n){var t=new Set(n);return e.forEach(function(e){t.delete(e.id)}),t})}},[nk]),nK=(0,u.useCallback)((ew=(0,I.Z)(function(e,n,t,r){var a,o,i=arguments;return(0,F.__generator)(this,function(s){return a=!(i.length>4)||void 0===i[4]||i[4],o=i.length>5?i[5]:void 0,r&&nQ(),e!==H.Os.Continue&&nn(nj.current.getTextFromNode(n))||(eF(e$.current),nY(o?(0,w.xt)(eP.has("priority_driven_models_list"),nh):nx,e,n,t,a)),[2]})}),function(e,n,t,r){return ew.apply(this,arguments)}),[nn,eF,nY,eP,nh,nx,nQ,]),n0=(0,u.useCallback)(function(e,n,t,r){nj.current.addNode(e,r,n,H.Jq.Prompt)},[]),n1=(0,u.useCallback)(function(e,n,t){var r=n.value;n0(e,nk,H.Jq.Prompt,r),nK(H.Os.Next,e,t,!0)},[nk,n0,nK]),n2=(0,u.useMemo)(function(){var e,n,t=nj.current.getNode(nk),r=t.type===H.Jq.Prompt,a=(null===(e=t.metadata)||void 0===e?void 0:e.err)&&(null===(n=t.metadata)||void 0===n?void 0:n.errCode)!==$.Dd;return Boolean(r||a)&&0===nE.size},[nE.size,nk]),n3=(0,w.CS)(function(e){return e.isoDate}),n4=(0,u.useMemo)(function(){var e,n=(null===(e=nj.current.getNode(nk).metadata)||void 0===e?void 0:e.errCode)===w.uU;return n2&&n&&n3},[nk,n2,n3]),n6=(0,u.useCallback)(function(e,n){var t,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3?arguments[3]:void 0;t=n2?nj.current.getLastValidNode(e).id:nj.current.getParentPromptNode(e).id,nK(H.Os.Variant,t,n,!1,r,a)},[nK,n2]),n5=(0,u.useCallback)(function(e){nK(H.Os.Continue,e,{eventSource:"mouse"},!1)},[nK]),n7=(0,u.useCallback)(function(e){var n=nk,t=!0,r=!1,a=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;nj.current.addNode(s.message.id,s.message,n,H.Jq.Completion),s.conversation_id&&(e$.current=s.conversation_id),n=s.message.id}}catch(l){r=!0,a=l}finally{try{t||null==i.return||i.return()}finally{if(r)throw a}}nN(n),nK(H.Os.Next,n,{},!0)},[nK,nk,nN,e$]),n8=!!(eP.has("tools2")&&(null==ny?void 0:null===(r=ny.enabledTools)||void 0===r?void 0:r.includes("tools2"))),te=(0,u.useCallback)((ek=(0,I.Z)(function(e){var n;return(0,F.__generator)(this,function(r){switch(r.label){case 0:if(!n8)return[3,3];return e.preventDefault(),e.stopPropagation(),n=e.currentTarget.href,[4,t.e(949).then(t.bind(t,93949))];case 1:return[4,r.sent().handleSandboxLinkClick(eP,ny,e$)(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})}),function(e){return ek.apply(this,arguments)}),[eP,ny,e$,n8]),tn=(0,u.useCallback)(function(e){nN(nj.current.getLeafFromNode(e).id),eM(m.s6.changeNode)},[eM,nN]),tt=(0,u.useCallback)(function(e,n){nj.current.updateNodeText(e,n)},[]),ti=(0,u.useCallback)(function(e,n,t){eM(m.s6.thumbRating,{id:n,threadId:e$.current,rating:t,model:nx}),e$.current&&G.ZP.submitMessageFeedback({message_id:n,conversation_id:e$.current,rating:t}),eA(e),eB(n),eE(t);var r=nj.current.getMetadata(e);if(nj.current.updateNode(e,{metadata:{$set:(0,T.Z)((0,S.Z)({},r),{rating:t})}}),"thumbsDown"===t&&e_){var a,o=null===(a=nj.current)||void 0===a?void 0:a.getConversationTurns(e||"root");nC(o[o.length-1])&&n6(e,{eventSource:"mouse"},!1)}},[eM,nx,n6,e_,]),ts=(0,u.useCallback)(function(e,n){eD&&eU&&(e||n.length>0)&&(eM(m.s6.reportResult,{id:ez,threadId:e$.current,content:e,model:nx,rating:eD,tags:n}),e$.current&&ez&&G.ZP.submitMessageFeedback({message_id:ez,conversation_id:e$.current,rating:eD,text:e,tags:n}))},[eM,nx,eU,ez,eD,]),tl=(0,u.useCallback)((eC=(0,I.Z)(function(e,n,t,r,a,o,i,s,l,u,c){return(0,F.__generator)(this,function(d){switch(d.label){case 0:return[4,G.ZP.submitMessageComparisonFeedback({feedback_version:"comparison_feedback_modal:a:1.0",original_message_id:e,new_message_id:n,rating:t,conversation_id:e$.current,text:u,tags:c.map(function(e){return e.replace("feedback-","")}),completion_comparison_rating:r,new_completion_placement:a,feedback_start_time:o,compare_step_start_time:i,new_completion_load_start_time:s,new_completion_load_end_time:l,frontend_submission_time:Date.now()})];case 1:return d.sent(),[2]}})}),function(e,n,t,r,a,o,i,s,l,u,c){return eC.apply(this,arguments)}),[]),tu=(0,u.useCallback)((eZ=(0,I.Z)(function(e,n,t,r,a,o,i){return(0,F.__generator)(this,function(s){switch(s.label){case 0:return[4,G.ZP.submitMessageComparisonFeedback({feedback_version:"inline_regen_feedback:a:1.0",original_message_id:e,new_message_id:n,rating:"none",conversation_id:e$.current,text:"",tags:[],completion_comparison_rating:t,new_completion_placement:"not-applicable",feedback_start_time:r,compare_step_start_time:a,new_completion_load_start_time:o,new_completion_load_end_time:i,frontend_submission_time:Date.now()})];case 1:return s.sent(),[2]}})}),function(e,n,t,r,a,o,i){return eZ.apply(this,arguments)}),[]),tc=(0,u.useCallback)(function(e){nj.current.deleteNode(e)},[]),td=(0,u.useCallback)(function(e){switch(null==e?void 0:e.state){case"pending":n0("artifact","root",H.Jq.Prompt,e.url),n0("artifact-summary","artifact",H.Jq.Completion,"loading..."),nN("artifact"),nR(e);break;case"success":tt("artifact-summary",e.contents),nN("artifact-summary"),nR(e);break;default:nR(e)}},[n0,tt,nN]),tm=(0,u.useCallback)(function(){nf(function(e){return"debug"!==e&&"debug"})},[]),tf=(0,u.useCallback)(function(){eM(m.s6.clickSidebarAccountPortalMenuItem),nc(!0)},[eM,nc]),th=(0,u.useCallback)(function(){nc(!1)},[nc]),tg=rE(function(e){return{setShowAccountPaymentModal:e.setShowAccountPaymentModal,showAccountPaymentModal:e.showAccountPaymentModal}}),tp=tg.showAccountPaymentModal,tv=tg.setShowAccountPaymentModal,tx=(0,u.useCallback)(function(){tv(!0,function(){eM(m.s6.clickSidebarAccountPaymentMenuItem)})},[eM,tv]),tb=(0,u.useCallback)(function(){tv(!1)},[tv]),ty=(0,u.useCallback)(function(){nf(function(e){return"navigation"!==e&&"navigation"})},[]),tw=(0,u.useCallback)(function(e,n){if(nj.current.isFirstCompletion){var t,r=nj.current.getParent(n);(null===(t=r.metadata)||void 0===t?void 0:t.errCode)!==$.Dd&&setTimeout(function(){nJ(r.message.id)},500)}nq(function(e){var t=e[n],r=(0,M.Z)(e,[n].map(_.Z));return null==t||t.abort(),r}),nL(function(e){var t=new Set(e);return t.delete(n),t})},[nJ]),tk=(0,u.useCallback)(function(e,n){var t=n.id,r=n.aborter;r&&nq(function(e){return(0,T.Z)((0,S.Z)({},e),(0,P.Z)({},t,r))})},[]),tC=(0,u.useCallback)(function(){nq(function(e){return Object.values(e).forEach(function(e){return e.abort()}),{}}),nL(new Set),nN("root"),nR(null),nj.current=new X.Cv,e$.current="",nS(!0),e3(),nx===w.f_&&eS.replace("/chat",void 0,{shallow:!0})},[nx,e3,eS]),tZ=(0,u.useCallback)(function(){G.ZP.deleteConversations().then(function(){e3()}),eS.asPath!==aa?eS.replace({pathname:aa}):tC()},[tC,e3,eS]),tP=(0,u.useCallback)(function(){ns(!0)},[]);(0,u.useEffect)(function(){var e=O().subscribe("AbortCompletion",tw),n=O().subscribe("PublishAborter",tk),t=O().subscribe("UnrecoverableError",tP);return function(){O().unsubscribe(e),O().unsubscribe(n),O().unsubscribe(t)}},[tw,tk,tP]);var tS=(0,u.useMemo)(function(){return nj.current.getConversationTurns(nk||"root")},[nk]),tT=(0,u.useMemo)(function(){return 0===tS.length?nk:X.Cv.getRequestIdFromConversationTurn(tS[tS.length-1])},[tS,nk]),tM=(0,u.useState)(""),tR=tM[0],t_=tM[1],tq=(0,u.useCallback)(function(){na(!0),f.m.setItem("oai/librarian/hasSeenWarning","true")},[]),tD=(0,u.useCallback)(function(){e8(!1)},[]),tE=(0,u.useMemo)(function(){return eP.has("debug")?new Set([w.G3.Model]):new Set},[eP]),tL=(0,u.useMemo)(function(){if(!eP.has("can_continue"))return!1;if(!nF[nk]){var e=nj.current.getHasErrorFromNode(nk),n=nj.current.isMessageIncomplete(nk);return!e&&n}return!1},[nF,nk,eP]),tU=void 0!==eJ&&eJ,tA=(0,rb().getHasSeenOnboardingDate)(),tO=tA&&new Date("2023-01-11")>tA&&!localStorage.getItem(ar);(0,u.useEffect)(function(){tO&&(p.m.success("Your previously unavailable conversation history has been restored! Your previous conversations can now be viewed and continued as normal. We apologize for any inconvenience caused by the recent outage. Thank you for your patience and understanding.",{hasCloseButton:!0,duration:0}),localStorage.setItem(ar,"true"))},[tO]);var tz=(0,u.useMemo)(function(){return(0,o.jsx)(nH,{items:e0||[],activeId:nP?"":e$.current,hasNextPage:Boolean(e1),onNextPage:e2,onNewThread:tC,onRefetchHistory:e3,onUpdateUserModifiedTitle:nG,userModifiedTitle:n$,newChatName:nz,isLoading:e4,isError:e6})},[e0,nP,e1,e2,tC,e3,n$,nz,e4,e6,]),tB=tS.length<2,tV=tF();return(0,o.jsxs)(ai,{children:[(0,o.jsx)(U(),{children:(0,o.jsx)("title",{children:nW})}),!nr&&(0,o.jsx)(c.Z,{isOpen:!0,onModalClose:tq,icon:D.Z,title:"Do not share sensitive materials with this application",primaryButton:(0,o.jsx)(c.m,{onClick:tq,title:"Acknowledge"}),type:"danger"},"OnboardingModal"),ne&&e7&&(0,o.jsx)(c.Z,{isOpen:!0,onModalClose:tD,icon:z.U0j,title:"This prompt may violate our content policy.",primaryButton:(0,o.jsx)(c.m,{onClick:tD,title:"Acknowledge"}),type:"danger"},"RestrictedTerms"),Boolean(eD)&&(0,o.jsx)(nZ,{treeRef:nj,ratingModalNodeId:eU,ratingModalOpen:eD,setRatingModalOpen:eE,handleSubmitFeedback:ts,setCurrentLeafId:nN,onHandleChangeFeedbackComparisonRating:tl,modelBackend:nx,feedbackTextareaRef:eV,threadIdRef:e$,activeRequests:nE,onChangeItemInView:tn,onRequestMoreCompletions:n6,onUpdateNode:tt,onChangeRating:ti,onDeleteNode:tc,onRequestCompletion:nK,onSandboxLinkClick:te}),(0,o.jsxs)("div",{className:"flex h-full flex-1 flex-col md:pl-[260px]",children:[eT&&(0,o.jsx)(to,{onNewThread:tC,onSidebarOpen:ty,title:eN.title,newChatName:nz}),(0,o.jsxs)(as,{className:"flex-1 ",children:[(0,o.jsx)(al,{children:(0,o.jsx)(rs,{children:(0,o.jsx)(re,{isLoading:eI||eW&&!eG,onChangeItemInView:tn,onRequestMoreCompletions:n6,onUpdateNode:tt,onChangeRating:ti,onDeleteNode:tc,onRequestCompletion:nK,onChangeCurrentPrompt:t_,onSandboxLinkClick:te,onHandleChangeVariantFeedbackInlineComparisonRating:tu,threadId:e$.current,treeRef:nj,conversationTurns:tS,activeRequests:nE,isProcessingArtifact:(null==nM?void 0:nM.state)==="pending",onChangeModelSetting:nb,availableModels:nh,currentThreadModel:eN.lastModelUsed,canShowThreadSettings:eP.has("model_switcher")&&nh.length>1})})}),(0,o.jsxs)(au,{children:[eP.has("model_preview")&&tB&&nx===w.f_&&(0,o.jsx)("div",{className:"stretch mx-2 mb-2 text-center text-xs text-gray-600 dark:text-gray-200 md:mx-4 md:text-sm lg:m-auto lg:max-w-3xl",children:tV.textareaDisclaimer}),!n4&&(0,o.jsx)(tj,{currentLeafId:nk,currentRequestId:tT,threadId:e$.current,currentPrompt:tR,onChangeCurrentPrompt:t_,onRequestMoreCompletions:n6,onCreateNewCompletion:n1,onAbortCompletion:tw,onContinueGenerating:n5,onFileUpload:n7,modelBackend:nx,canUpload:n8,isCompletionInProgress:nE.has(tT),onUpdateArtifactStatus:td,treeRef:nj,artifact:nM,className:(0,E.Z)("stretch mx-2 flex flex-row gap-3 last:mb-2 md:mx-4 md:last:mb-6 lg:mx-auto lg:max-w-3xl"),shouldRetry:n2,canContinue:tL,disabled:!nh.length,canPause:Boolean(nF[tT])}),!eJ&&(0,o.jsxs)("div",{className:"px-3 pt-2 pb-3 text-center text-xs text-black/50 dark:text-white/50 md:px-4 md:pt-3 md:pb-6",children:[(0,o.jsx)("a",{href:"https://help.openai.com/en/articles/6825453-chatgpt-release-notes",target:"_blank",rel:"noreferrer",className:"underline",children:"ChatGPT Mar 14 Version"}),". Free Research Preview. Our goal is to make AI systems more natural and safe to interact with. Your feedback will help us improve."]})]})]})]}),eT&&(0,o.jsx)(ta,{onSidebarOpen:ty,sidebarOpen:"navigation"===nm,onClickAccountPayment:tx,showAccountPaymentMenuItem:!tU&&eY,onClickCustomerPortal:tf,showCustomerPortalMenuItem:tU,onDeleteHistory:tZ,showDeleteHistory:Boolean(null==e0?void 0:e0.length),onNewThread:tC,onOpenDebugPanel:tm,children:tz}),!eT&&(0,o.jsx)(tr,{onClickAccountPayment:tx,showAccountPaymentMenuItem:!tU&&eY,onClickCustomerPortal:tf,showCustomerPortalMenuItem:tU,onDeleteHistory:tZ,showDeleteHistory:Boolean(null==e0?void 0:e0.length),onNewThread:tC,onOpenDebugPanel:tm,settings:tE.size>0&&(0,o.jsx)(tN.ZP,{temperature:nv,onRestoreDefaults:nX,onChangeModelSetting:nb,position:"top-right",modelSettings:tE,features:eP,children:(0,o.jsxs)(q.J.Button,{as:n9,children:[(0,o.jsx)(j.ZP,{icon:z.nbt}),"Settings"]})}),children:tz}),(0,o.jsx)(tI,{icon:z.cDN,title:"Debug",sidebarOpen:"debug"===nm,onSidebarOpen:ty,children:(0,o.jsx)(rG,{treeRef:nj,currentLeafId:nk})}),eY&&(0,o.jsx)(rF.Z,{isOpen:tp,onClose:tb}),tU&&(0,o.jsx)(r_,{isOpen:nu,onClose:th}),ni&&(0,o.jsx)(c.Z,{onModalClose:s(),isOpen:!0,icon:D.Z,title:"Something went wrong",description:"We're sorry, but something went wrong. Please try again later.",primaryButton:(0,o.jsx)(c.m,{onClick:function(){tC(),ns(!1)},title:"Reset thread"}),type:"danger"},"UnrecoverableErrorModal")]})},ai=B.Z.div(r9()),as=B.Z.main(ae()),al=B.Z.div(an()),au=B.Z.div(at()),ac=t(49690),ad=!0;function am(e){var n,t,r,a,i,f,g,v,b,y,j,k,C,N,I=e.user,P=e.isUserInCanPayGroup,R=e.serviceStatus,_=e.serviceAnnouncement,F=(0,u.useState)(!1),q=F[0],D=F[1],E=(0,l.useRouter)(),L=rb().getHasSeenOnboardingDate,U=(0,h.nR)(),A=(a=(r={threadId:(null===(n=E.query.chatId)||void 0===n?void 0:n[0])||""}).threadId,i=(0,l.useRouter)(),f=(0,V.kP)().session,g=r0().availableModels,v=(0,rS.p0)(),b=(0,w.ZP)(g,null,a).modelBackend,y=(0,u.useMemo)(function(){return g.find(function(e){return e.id===b})},[g,b]),k=(j=(0,tR.a)(["conversation",a],function(){return G.ZP.getConversation(a,null==f?void 0:f.accessToken)},{enabled:Boolean(a&&(null==f?void 0:f.accessToken)),onError:function(){i.replace("/chat"),p.m.danger("Unable to load conversation ".concat(a))}})).data,C=j.isLoading,N=(0,u.useMemo)(function(){if(k){var e,n,t,r,a,o,s,l,u=(a=null===(r=Object.values(k.mapping).find(function(e){return null===e.parent}))||void 0===r?void 0:r.id,o=new Set,s=new Set,(k.moderation_results||[]).forEach(function(e){e.blocked?s.add(e.message_id):e.flagged&&o.add(e.message_id)}),{rootId:a,mapping:Object.keys(k.mapping).reduce(function(e,n){var t,r=k.mapping[n],a=r.parent,i=r.children,l=(0,M.Z)(r,["parent","children"]),u=k.mapping[n].message||X.Cv.createRootMessage();return s.has(u.id)?t=$.sK:o.has(u.id)&&(t=$.Mf),e[n]=(0,S.Z)((0,T.Z)((0,S.Z)({},l),{message:u,children:i||[],parentId:a||"",type:X.uV[X.Cv.getRoleFromMessage(u)]}),t&&{metadata:t}),e},{}),currentLeafId:k.current_node});return{thread:u.mapping||X.Cv.createTree(),currentLeafId:u.currentLeafId||u.rootId||"root",threadId:null===(l=i.query.chatId)||void 0===l?void 0:l[0],title:k.title||null,lastModelUsed:function e(n,t){var r,a,o=n[t];return(null==o?void 0:null===(r=o.message)||void 0===r?void 0:null===(a=r.metadata)||void 0===a?void 0:a.model_slug)?o.message.metadata.model_slug:(null==o?void 0:o.parentId)?e(n,o.parentId):(console.log("No model found in conversation tree"),null)}(u.mapping,u.currentLeafId),pluginIds:k.plugin_ids||[]}}return n=(null==y?void 0:null===(e=y.enabledTools)||void 0===e?void 0:e.includes("tools3"))?v.map(function(e){return e.id}):[],{thread:X.Cv.createTree(),currentLeafId:"root",threadId:null,title:"New chat",lastModelUsed:null,pluginIds:n||[]}},[k,y,v,i.query.chatId]),(0,u.useMemo)(function(){return{threadData:N,isLoading:Boolean(a&&C)}},[C,N,a])),O=A.threadData,z=A.isLoading,B=(0,rQ.Z)(),H=B.accountStatusResponse,J=B.isLoading,Y=(0,W.g)(function(e){return e.updateFlagValue});(0,u.useEffect)(function(){void 0!==P&&Y("isUserInCanPayGroup",P)},[Y,P]),(0,u.useEffect)(function(){(null==R?void 0:R.type)&&void 0!==U&&!U&&p.m.warning(R.message,{hasCloseButton:!0,duration:5})},[U,null==R?void 0:R.message,null==R?void 0:R.type]);var Q=(0,u.useMemo)(function(){return{app:m.VY,origin:"chat"}},[]),K=(0,h.mA)(function(e){return{accountPlan:e.accountPlan,updateAccountPlanWithResponse:e.updateAccountPlanWithResponse}}),ee=K.accountPlan,en=K.updateAccountPlanWithResponse;(0,ac.Z)("ChatGPT",I,Q,null==H?void 0:H.account_plan,{},!J),(0,u.useEffect)(function(){if(!J&&H){var e;(null==ee?void 0:ee.hasPaidSubscription)!==(null===(e=H.account_plan)||void 0===e?void 0:e.is_paid_subscription_active)&&H&&en(H)}},[J,en,H,ee,]),(0,u.useEffect)(function(){D(!L())},[L]);var et=(0,u.useMemo)(function(){return new Set((null==O?void 0:O.pluginIds)||[])},[null==O?void 0:O.pluginIds]),er=(0,u.useRef)(!1);return(0,u.useEffect)(function(){if(!J&&H){var e,n=(null===(e=H.account_plan)||void 0===e?void 0:e.is_paid_subscription_active)?_.paid:_.public;if((null==n?void 0:n.type)&&(null==n?void 0:n.message)&&!er.current){er.current=!0;var t=n.message,r={hasCloseButton:!0,duration:15};switch(n.type){case"danger":p.m.danger(t,r);break;case"info":p.m.info(t,r);break;case"warning":p.m.warning(t,r)}}}},[_,J,H]),(0,o.jsx)(d.Af.Provider,{value:Q,children:(0,o.jsxs)(ti.A.Provider,{value:et,children:[(0,o.jsx)(c.Z,{isOpen:q,onModalClose:s(),type:"success",title:"",primaryButton:void 0,children:(0,o.jsx)(ry,{onClose:function(){return D(!1)}})}),!J&&H&&(0,o.jsx)(Z,{isUserPaid:null===(t=H.account_plan)||void 0===t?void 0:t.is_paid_subscription_active,hasSeenOnboardingDate:L()}),(0,o.jsx)(x,{}),(0,o.jsx)(ao,{initialData:O,isLoading:z},O.threadId||"new")]})})}},68619:function(e,n,t){"use strict";var r,a,o,i,s,l,u,c,d,m;t.d(n,{Jq:function(){return s},Os:function(){return o},uU:function(){return i}}),(l=r||(r={})).Default="default",l.Dark="dark",(u=a||(a={})).Retrieval="retrieval",(c=o||(o={})).Next="next",c.Variant="variant",c.Continue="continue",(d=i||(i={})).Unknown="unknown",d.User="user",d.Assistant="assistant",d.System="system",d.Critic="critic",d.Tool="tool",(m=s||(s={})).Root="root",m.System="system",m.Prompt="prompt",m.Completion="completion"},60363:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(35250),a=t(19841);function o(e){var n=e.url,t=e.name,o=e.size,i=e.large;return(0,r.jsxs)("div",{className:"relative",style:{width:o,height:o},children:[(0,r.jsx)("img",{src:n,alt:"".concat(t," logo"),className:(0,a.Z)("h-full w-full bg-white",i?"rounded-[5px]":"rounded-sm")}),(0,r.jsx)("div",{className:(0,a.Z)("absolute inset-0 ring-1 ring-inset ring-black/10",i?"rounded-[5px]":"rounded-sm")})]})}},23119:function(e,n,t){"use strict";t.d(n,{Ph:function(){return y},Yt:function(){return k},k$:function(){return b}});var r=t(14806),a=t(35250),o=t(19841),i=t(96424),s=t.n(i),l=t(1454),u=t(13002),c=t(34303),d=t(60363),m=t(79876);function f(){var e=(0,r.Z)(["relative h-[30px] w-[30px] p-1 rounded-sm text-white flex items-center justify-center"]);return f=function(){return e},e}function h(){var e=(0,r.Z)(["\n  absolute w-4 h-4 rounded-full text-[10px] text-white flex  justify-center items-center right-0 top-[20px] -mr-2 border border-white\n  ","\n  ","\n"]);return h=function(){return e},e}function g(){var e=(0,r.Z)(["bg-[#5436DA] rounded-sm text-white flex justify-center items-center relative tracking-widest"]);return g=function(){return e},e}function p(){var e=(0,r.Z)(["relative flex"]);return p=function(){return e},e}var v=c.Z.div(f()),x=c.Z.span(h(),function(e){return"warning"===e.$type&&"bg-orange-500 text-white"},function(e){return"danger"===e.$type&&"bg-red-500 text-white"}),b=function(e){var n=e.iconName,t=e.background,r=e.notice,o=m.nI;switch(n){case"globe":o=l.RsK;break;case"terminal":o=l.cDN;break;case"t":o=l.RUS;break;case"s":o=l.jRj;break;case"c":o=u.oT$;break;case"p":o=l.yG}return(0,a.jsxs)(v,{style:{backgroundColor:t},children:[(0,a.jsx)(m.ZP,{icon:o,size:"medium"}),r&&(0,a.jsx)(x,{$type:r,children:"!"})]})},y=function(e){var n=e.plugin,t=e.notice;return(0,a.jsxs)(v,{className:"p-0",children:[(0,a.jsx)(d.Z,{url:n.manifest.logo_url,name:n.manifest.name_for_human,size:"100%"}),t&&(0,a.jsx)(x,{$type:t,children:"!"})]})},j=c.Z.div(g()),w=c.Z.div(p()),k=function(e){var n=e.user,t=e.size,r=void 0===t?"small":t,i=e.notice,u=i&&(0,a.jsx)(x,{$type:i,children:"!"});if(null==n?void 0:n.picture)return(0,a.jsxs)(w,{children:[(0,a.jsx)(s(),{src:n.picture,alt:n.name,width:"small"===r?30:38,height:"small"===r?30:38,className:"rounded-sm"}),u]});var c=((null==n?void 0:n.name)||"").split(" ").map(function(e){return e[0]}).join("");return(0,a.jsxs)(j,{className:(0,o.Z)("small"===r?"h-8 w-8 text-xs":"h-10 w-10 text-lg"),children:[c||(0,a.jsx)(m.ZP,{icon:l.fzv,size:"medium"}),u]})}},43404:function(e,n,t){"use strict";t.d(n,{$:function(){return v},Z:function(){return p}});var r=t(14806),a=t(35250),o=t(70079),i=t(34303),s=t(35873);function l(){var e=(0,r.Z)(["bg-black rounded-md"]);return l=function(){return e},e}function u(){var e=(0,r.Z)(["flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"]);return u=function(){return e},e}function c(){var e=(0,r.Z)(["p-4 overflow-y-auto"]);return c=function(){return e},e}function d(){var e=(0,r.Z)(["!whitespace-pre"]);return d=function(){return e},e}var m=i.Z.div(l()),f=i.Z.div(u()),h=i.Z.div(c()),g=i.Z.code(d());function p(e){var n=e.children,t=e.className,r=e.language,i=e.content,l=(0,o.useCallback)(function(){navigator.clipboard.writeText(i)},[i]);return(0,a.jsx)(v,{title:r,headerDecoration:(0,a.jsx)(s.Z,{text:"Copy code",onCopy:l}),className:"mb-4",codeClassName:t,children:n})}function v(e){var n=e.children,t=e.title,r=e.headerDecoration,o=e.className,i=e.codeClassName;return(0,a.jsxs)(m,{className:o,children:[(0,a.jsxs)(f,{children:[t&&(0,a.jsx)("span",{children:t}),r]}),(0,a.jsx)(h,{children:(0,a.jsx)(g,{className:i,children:n})})]})}},35873:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});var r=t(14806),a=t(35250),o=t(70079),i=t(1454),s=t(34303),l=t(60612),u=t(79876);function c(){var e=(0,r.Z)(["flex ml-auto gap-2"]);return c=function(){return e},e}function d(e){var n=e.text,t=e.onCopy,r=(0,o.useState)(!1),s=r[0],c=r[1],d=(0,l.Z)(),f=(0,o.useCallback)(function(){t(),c(!0),setTimeout(function(){d()&&c(!1)},2e3)},[d,t]);return(0,a.jsxs)(a.Fragment,{children:[!s&&(0,a.jsxs)(m,{onClick:f,children:[(0,a.jsx)(u.ZP,{icon:i.j4u}),n]}),s&&(0,a.jsxs)(m,{children:[(0,a.jsx)(u.ZP,{icon:i.UgA}),n&&"Copied!"]})]})}var m=s.Z.button(c())},31425:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});var r=t(35250);function a(e){var n,t=e.url,a=e.size,o=void 0===a?16:a,i=e.className;try{n=new URL(t)}catch(s){return console.error(s),null}return(0,r.jsx)("img",{src:"https://icons.duckduckgo.com/ip3/".concat(n.hostname,".ico"),alt:"Favicon",width:o,height:o,className:i})}},36284:function(e,n,t){"use strict";t.d(n,{D2:function(){return R},ze:function(){return U},YA:function(){return F},Vp:function(){return O},ZP:function(){return _}});var r=t(31501),a=t(89874),o=t(14806),i=t(35250),s=t(35888),l=t(40638),u=t(57526),c=t(19841),d=t(70079),m=t(99581),f=t(1454),h=t(34303),g=t(11699),p=t(60363),v=t(79876),x=t(42928),b=t(30892),y=t.n(b),j=t(7361),w=t.n(j);function k(e){var n=e.values,t=e.className,r=Object.keys(n),a=Object.values(n);return(0,i.jsxs)("div",{className:(0,c.Z)("flex w-full items-stretch gap-2",t),children:[(0,i.jsx)("div",{className:"flex w-1/2 flex-col justify-between gap-1 text-sm text-gray-600 dark:text-gray-300",children:r.map(function(e,n){return(0,i.jsx)("span",{children:y()(e)},n)})}),(0,i.jsx)("div",{className:"my-1.5 flex flex-1 flex-col justify-between gap-2",children:a.map(function(e,n){var t=(0,x.Z)(e,2),r=t[0],a=t[1];return(0,i.jsx)(C,{num:r,max:a},n)})})]})}function C(e){var n=e.num,t=e.max,r=(0,d.useMemo)(function(){var e=w()(Array(t),!1);return w()(e,!0,0,n)},[t,n]);return(0,i.jsx)("div",{className:"flex w-full gap-1",children:r.map(function(e,n){return(0,i.jsx)("div",{className:(0,c.Z)("h-2 w-full rounded-lg",e?"bg-green-600":"bg-gray-200 dark:bg-gray-600"),children:e},n)})})}var Z=t(1744);function N(){var e=(0,o.Z)(["rounded bg-white ring-1 ring-black/10 dark:bg-gray-800 dark:ring-white/20"]);return N=function(){return e},e}function I(){var e=(0,o.Z)(["absolute z-10 mt-2 max-h-60 w-full overflow-auto text-base focus:outline-none dark:last:border-0 sm:text-xs md:w-[100%]"]);return I=function(){return e},e}function P(){var e=(0,o.Z)(["absolute z-10 -ml-[1px] flex flex-col gap-2 p-3 sm:p-4"]);return P=function(){return e},e}function S(){var e=(0,o.Z)(["flex items-center gap-1.5 truncate"]);return S=function(){return e},e}function T(){var e=(0,o.Z)(["h-6 w-6 shrink-0"]);return T=function(){return e},e}function M(){var e=(0,o.Z)(["absolute inset-y-0 right-0 flex items-center pr-3 text-gray-800 dark:text-gray-100"]);return M=function(){return e},e}var R=["confidential","alpha","plus"];function _(e){var n=e.selectedOption,t=e.onChange,o=e.onAction,l=e.dropdownRef,u=(0,a.Z)(e,["selectedOption","onChange","onAction","dropdownRef"]),c=(0,d.useCallback)(function(e){"string"==typeof e?null==o||o(e):t(e)},[t,o]);return(0,i.jsx)(s.R,{value:n.value,onChange:c,children:function(e){var t=e.open;return(0,i.jsx)(q,(0,r.Z)({ref:l,selectedLabel:(0,i.jsxs)(i.Fragment,{children:[n.title,n.tags.map(function(e){return O(e)}),n.customTags]}),open:t},u))}})}function F(e){var n=e.selectedOptions,t=e.selectedLabel,o=e.onChange,l=e.onAction,u=e.dropdownRef,c=(0,a.Z)(e,["selectedOptions","selectedLabel","onChange","onAction","dropdownRef"]),m=(0,d.useCallback)(function(e){if(e.some(function(e){return"string"==typeof e})){var n=e.find(function(e){return"string"==typeof e});null==l||l(n)}else o(e)},[o,l]);return(0,i.jsx)(s.R,{value:n.map(function(e){return e.value}),multiple:!0,onChange:m,children:function(e){var a=e.open;return(0,i.jsx)(q,(0,r.Z)({ref:u,selectedLabel:t||"".concat(n.length," selected"),open:a,multiple:!0},c))}})}var q=(0,d.forwardRef)(function(e,n){var t=e.name,r=e.selectedLabel,a=e.open,o=e.options,h=e.actions,x=e.multiple,b=e.isLoading,y=e.loadingState,j=e.header,w=(0,d.useRef)(null),k=(0,d.useRef)(null),C=(0,g.dD)();(0,d.useImperativeHandle)(n,function(){return{open:function(){if(!a){var e;null===(e=w.current)||void 0===e||e.click()}},close:function(){if(a){var e;null===(e=w.current)||void 0===e||e.click()}}}},[a]);var N=b?y||(0,i.jsx)("div",{className:"flex h-[42px] items-center justify-center",children:(0,i.jsx)(Z.Z,{})}):(0,i.jsxs)(i.Fragment,{children:[j,o.map(function(e,n){return(0,i.jsx)(D,{value:e.value,disabled:e.disabled,children:function(n){var t=n.selected,r=n.active;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(H,{children:[e.imageUrl&&(0,i.jsx)(G,{children:(0,i.jsx)(p.Z,{url:e.imageUrl,name:e.title,size:"100%"})}),(0,i.jsxs)("span",{className:(0,c.Z)(t&&!x&&"font-semibold","flex h-6 items-center gap-1 text-gray-800 dark:text-gray-100"),children:[e.title,e.tags.map(function(e){return O(e)}),e.customTags]})]}),x&&!e.disabled?(0,i.jsx)(L,{selected:t}):t&&(0,i.jsx)(E,{icon:f.UgA}),e.disabled&&(0,i.jsx)(E,{icon:u.Z,className:"text-red-700 dark:text-red-500"}),r&&!C&&(0,m.createPortal)((0,i.jsx)(A,{option:e,dropdownRef:k}),document.body)]})}},n)}),null==h?void 0:h.map(function(e,n){return(0,i.jsx)(D,{value:e.id,children:function(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"text-gray-800 dark:text-gray-100",children:e.label}),(0,i.jsx)(E,{icon:e.icon})]})}},n)})]});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"relative w-full md:w-1/2 lg:w-1/3 xl:w-1/4",children:[(0,i.jsxs)(s.R.Button,{ref:w,className:"relative flex w-full cursor-default flex-col rounded-md border border-black/10 bg-white py-2 pl-3 pr-10 text-left focus:border-green-600 focus:outline-none focus:ring-1 focus:ring-green-600 dark:border-white/20 dark:bg-gray-800 sm:text-sm",children:[(0,i.jsx)(s.R.Label,{className:"block text-xs text-gray-700 dark:text-gray-500",children:t}),(0,i.jsx)("span",{className:"inline-flex w-full truncate",children:(0,i.jsx)("span",{className:"flex h-6 items-center gap-1 truncate",children:r})}),(0,i.jsx)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:(0,i.jsx)(v.ZP,{icon:f.bTu,className:" text-gray-400","aria-hidden":"true"})})]}),(0,i.jsx)(l.u,{show:a,as:d.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,i.jsx)(B,{$as:s.R.Options,ref:k,children:N})})]})})});function D(e){var n=e.value,t=e.disabled,r=e.children;return(0,i.jsx)(s.R.Option,{className:function(e){var n=e.active;return(0,c.Z)($,n&&!t?"bg-gray-100 dark:bg-gray-700":"text-gray-900",t&&"cursor-auto bg-gray-50 text-gray-400 dark:bg-gray-700 dark:text-gray-100")},value:n,children:r})}function E(e){var n=e.icon,t=e.className;return(0,i.jsx)(W,{children:(0,i.jsx)(v.ZP,{icon:n,className:(0,c.Z)("h-5 w-5",t),"aria-hidden":"true"})})}function L(e){var n=e.selected,t=e.disabled;return(0,i.jsx)(W,{children:(0,i.jsx)("div",{className:(0,c.Z)("flex h-6 w-6 items-center justify-center rounded-full border dark:border-white/20",n?"border-black/20":"border-black/5"),"aria-hidden":"true",children:(0,i.jsx)(v.ZP,{icon:f.UgA,className:(0,c.Z)("h-3 w-3 transition-opacity",n&&"opacity-100",!n&&"opacity-0",!n&&!t&&"group-hover:opacity-50"),strokeWidth:n?2.5:2})})})}function U(e){var n=e.showCheckbox;return(0,i.jsxs)("div",{className:(0,c.Z)($,"cursor-auto"),children:[(0,i.jsxs)(H,{children:[(0,i.jsx)(G,{children:(0,i.jsx)("div",{className:"h-full w-full rounded-sm bg-gray-200"})}),(0,i.jsx)("div",{className:"h-[12px] w-[88px] rounded-sm bg-gray-100"})]}),n&&(0,i.jsx)(L,{selected:!1,disabled:!0})]})}function A(e){var n=e.option,t=e.dropdownRef,r=(0,d.useState)(),a=r[0],o=r[1];(0,d.useEffect)(function(){var e=function(){if(t.current){var e,n=t.current.getBoundingClientRect(),r=n.top;o({top:r,left:n.left-260,minHeight:n.height})}};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[t]);var s=(0,d.useMemo)(function(){return n.value.properties?(0,i.jsx)(k,{values:n.value.properties,className:"mt-auto"}):null},[n.value.properties]);return a?(0,i.jsxs)(V,{style:{width:260,minHeight:a.minHeight,top:a.top,left:a.left},children:[n.disabled&&(0,i.jsx)(v.ZP,{icon:u.Z,size:"medium",className:"text-red-700 dark:text-red-500"}),n.imageUrl&&(0,i.jsx)(p.Z,{url:n.imageUrl,name:n.title,size:70}),(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[n.title," ",n.tags.map(function(e){return O(e)})," ",n.customTags]}),(0,i.jsx)("div",{className:"whitespace-pre-line text-xs",children:n.description}),!n.disabled&&s]}):null}var O=function(e){return R.includes(e)&&(0,i.jsx)("span",{className:(0,c.Z)("py-0.25 rounded px-1 text-[10px] font-semibold uppercase","confidential"===e&&"bg-red-200 text-red-800","alpha"===e&&"bg-blue-200 text-[#4559A4]","plus"===e&&"bg-yellow-200 text-yellow-900"),children:e},e)},z=h.Z.div(N()),B=(0,h.Z)(z)(I()),V=(0,h.Z)(z)(P()),$="group relative flex h-[42px] cursor-pointer select-none items-center overflow-hidden border-b border-black/10 pl-3 pr-9 last:border-0 dark:border-white/20",H=h.Z.span(S()),G=h.Z.span(T()),W=h.Z.span(M())},46275:function(e,n,t){"use strict";t.d(n,{bG:function(){return x},ZP:function(){return b}});var r=t(14806),a=t(35250),o=t(87093),i=t(40638),s=t(19841),l=t(70079),u=t(34303),c=t(62676),d=t(39690),m=t(6004);function f(e){var n=e.onChange,t=e.enabled,r=e.size,o=e.Icon,i=(0,l.useCallback)(function(){n(!t)},[t,n]),u=!t&&"translate-x-0";return(0,a.jsxs)(m.r,{checked:t,onChange:i,className:(0,s.Z)(t?"!bg-indigo-600":"!bg-gray-200","relative inline-flex flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-0","large"===r?"h-6 w-11":"h-4 w-8"),children:[(0,a.jsx)("span",{className:"sr-only",children:"Use setting"}),(0,a.jsxs)("span",{className:(0,s.Z)("pointer-events-none relative inline-block transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",t&&"large"===r?"translate-x-5":u,t&&"small"===r?"translate-x-4":u,"large"===r?"h-5 w-5":"h-3 w-3"),children:[(0,a.jsx)("span",{className:(0,s.Z)(t?"opacity-0 duration-100 ease-out":"opacity-100 duration-200 ease-in","absolute inset-0 flex h-full w-full items-center justify-center transition-opacity"),"aria-hidden":"true"}),(0,a.jsx)("span",{className:(0,s.Z)(t?"opacity-100 duration-200 ease-in":"opacity-0 duration-100 ease-out","absolute inset-0 flex h-full w-full items-center justify-center transition-opacity"),"aria-hidden":"true",children:o&&(0,a.jsx)(o,{className:"h-3 w-3 text-indigo-600"})})]})]})}var h=t(44819);function g(){var e=(0,r.Z)(["block w-full border-0 p-0 text-gray-900 placeholder-gray-500 focus:ring-0 outline-none border-none"]);return g=function(){return e},e}function p(){var e=(0,r.Z)(["mt-1 outline-none border-0"]);return p=function(){return e},e}function v(){var e=(0,r.Z)(["text-right"]);return v=function(){return e},e}var x="oai/apps/autoexpandCode";function b(e){var n=e.children,t=e.temperature,r=e.onRestoreDefaults,u=e.onChangeModelSetting,m=e.position,g=e.modelSettings,p=e.features,v=(0,l.useState)(Boolean(c.m.getItem(x))),b=v[0],k=v[1],C=(0,l.useCallback)(function(e){u(h.G3.Temperature,e.target.value)},[u]),Z=(0,l.useCallback)(function(e){k(e),c.m.setItem(x,e)},[]);return(0,a.jsxs)(o.J,{className:"relative",children:[n,(0,a.jsx)(i.u,{as:l.Fragment,enter:"transition ease-out duration-200",enterFrom:(0,s.Z)("opacity-0","top-right"===m?"translate-x-1":"translate-y-1"),enterTo:(0,s.Z)("opacity-100","top-right"===m?"translate-x-0":"translate-y-0"),leave:"transition ease-in duration-150",leaveFrom:(0,s.Z)("opacity-100","top-right"===m?"translate-x-0":"translate-y-0"),leaveTo:(0,s.Z)("opacity-0","top-right"===m?"translate-x-1":"translate-y-1"),children:(0,a.jsx)(o.J.Panel,{className:(0,s.Z)("absolute z-20 mt-3 w-screen max-w-xs px-2 sm:px-0","bottom-center"===m&&"right-0 top-6","bottom-right"===m&&"left-2 top-8","top-right"===m&&"left-full top-1/2 ml-6 -translate-y-full"),children:(0,a.jsx)("div",{className:"overflow-hidden rounded-lg text-left text-sm shadow-lg ring-1 ring-black ring-opacity-5 dark:ring-gray-600",children:(0,a.jsxs)("div",{className:"relative grid gap-6 bg-white px-2 py-1 dark:bg-gray-800 sm:gap-4 sm:p-4",children:[g.has(h.G3.Temperature)&&(0,a.jsxs)("div",{className:"rounded-md border border-gray-300 px-3 py-2 shadow-sm focus-within:border-indigo-600 focus-within:ring-1 focus-within:ring-indigo-600",children:[(0,a.jsx)("label",{htmlFor:"temperature",className:"block text-xs font-medium text-gray-800",children:"Temperature"}),(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)(y,{type:"number",name:"temperature",id:"temperature",onChange:C,value:t,className:"form-input"}),(0,a.jsx)(j,{name:"temperature",type:"range",min:"0",max:"1",value:t,className:"range w-full",step:"0.05",onChange:C})]})]}),p.has("tools2")&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-white",children:[(0,a.jsx)("div",{children:"Auto-expand code"}),(0,a.jsx)(f,{size:"small",enabled:b,onChange:Z})]}),(0,a.jsx)(w,{children:(0,a.jsx)(d.z,{as:"button",color:"neutral",onClick:r,children:"Restore defaults"})})]})})})})]})}var y=u.Z.input(g()),j=u.Z.input(p()),w=u.Z.div(v())},44525:function(e,n,t){"use strict";t.d(n,{Z:function(){return z}});var r=t(31501),a=t(61079),o=t(89874),i=t(35250),s=t(19841),l=t(15762),u=t(70079),c=t(45306),d=t(9871),m=t(66285),f=t(60612),h=t(61110),g=t(55975),p=t(46050),v=t(29874),x=t(8449),b=t(15472);function y(e,n,t){}function j(e,n){}let w={tokenize:function(e,n,t){let r=this,a=this.events[this.events.length-1],o=a&&a[1].type===b.V.linePrefix?a[2].sliceSerialize(a[1],!0).length:0,i=[];return function(n){return n!==g.q.backslash&&y("expected `\\`",n),e.enter("mathFlow"),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),function n(r){return(y("sequenceOpen",r),r===g.q.backslash||r===g.q.leftSquareBracket&&i[0]===g.q.backslash)?(e.consume(r),i.push(r),n):(e.exit("mathFlowFenceSequence"),i.length<2?t(r):(0,p.f)(e,s,b.V.whitespace)(r))}(n)};function s(n){return(y("metaOpen",n),n===g.q.eof||(0,v.Ch)(n))?l(n):(e.enter("mathFlowFenceMeta"),e.enter(b.V.chunkString,{contentType:x._.contentTypeString}),function n(r){return(y("meta",r),r===g.q.eof||(0,v.Ch)(r))?(e.exit(b.V.chunkString),e.exit("mathFlowFenceMeta"),l(r)):r===g.q.rightSquareBracket?t(r):(e.consume(r),n)}(n))}function l(t){return y("openAfter",t),e.exit("mathFlowFence"),r.interrupt?n(t):function n(t){return(y("contentStart",t),t===g.q.eof)?u(t):(0,v.Ch)(t)?e.attempt(k,e.attempt({tokenize:c,partial:!0},u,o?(0,p.f)(e,n,b.V.linePrefix,o+1):n),u)(t):(e.enter("mathFlowValue"),function t(r){return(y("contentContinue",r),r===g.q.eof||(0,v.Ch)(r))?(e.exit("mathFlowValue"),n(r)):(e.consume(r),t)}(t))}(t)}function u(t){return y("after",t),e.exit("mathFlow"),n(t)}function c(e,n,t){let r=[];return(0,p.f)(e,function(n){return y("closingPrefixAfter",n),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),function n(o){return(y("closingSequence",o),o===g.q.backslash&&0===r.length||o===g.q.rightSquareBracket&&r[0]===g.q.backslash)?(e.consume(o),r.push(o),n):r<i?t(o):(e.exit("mathFlowFenceSequence"),(0,p.f)(e,a,b.V.whitespace)(o))}(n)},b.V.linePrefix,x._.tabSize);function a(r){return(y("closingSequenceEnd",r),r===g.q.eof||(0,v.Ch)(r))?(e.exit("mathFlowFence"),n(r)):t(r)}}},concrete:!0},k={tokenize:function(e,n,t){let r=this;return function(n){return e.enter(b.V.lineEnding),e.consume(n),e.exit(b.V.lineEnding),a};function a(e){return r.parser.lazy[r.now().line]?t(e):n(e)}},partial:!0},C={tokenize:function(e,n,t){let r=this,a=r.events[r.events.length-1],o=a&&a[1].type===b.V.linePrefix?a[2].sliceSerialize(a[1],!0).length:0,i=0;return function(n){return n!==g.q.dollarSign&&y("expected `$`",n),e.enter("mathFlow"),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),function n(r){return(y("sequenceOpen",r),r===g.q.dollarSign)?(e.consume(r),i++,n):(e.exit("mathFlowFenceSequence"),i<2?t(r):(0,p.f)(e,s,b.V.whitespace)(r))}(n)};function s(n){return(y("metaOpen",n),n===g.q.eof||(0,v.Ch)(n))?l(n):(e.enter("mathFlowFenceMeta"),e.enter(b.V.chunkString,{contentType:x._.contentTypeString}),function n(r){return(y("meta",r),r===g.q.eof||(0,v.Ch)(r))?(e.exit(b.V.chunkString),e.exit("mathFlowFenceMeta"),l(r)):r===g.q.dollarSign?t(r):(e.consume(r),n)}(n))}function l(t){return y("openAfter",t),e.exit("mathFlowFence"),r.interrupt?n(t):function n(t){return(y("contentStart",t),t===g.q.eof)?u(t):(0,v.Ch)(t)?e.attempt(Z,e.attempt({tokenize:c,partial:!0},u,o?(0,p.f)(e,n,b.V.linePrefix,o+1):n),u)(t):(e.enter("mathFlowValue"),function t(r){return(y("contentContinue",r),r===g.q.eof||(0,v.Ch)(r))?(e.exit("mathFlowValue"),n(r)):(e.consume(r),t)}(t))}(t)}function u(t){return y("after",t),e.exit("mathFlow"),n(t)}function c(e,n,t){let r=0;return(0,p.f)(e,function(n){return y("closingPrefixAfter",n),e.enter("mathFlowFence"),e.enter("mathFlowFenceSequence"),function n(o){return(y("closingSequence",o),o===g.q.dollarSign)?(e.consume(o),r++,n):r<i?t(o):(e.exit("mathFlowFenceSequence"),(0,p.f)(e,a,b.V.whitespace)(o))}(n)},b.V.linePrefix,x._.tabSize);function a(r){return(y("closingSequenceEnd",r),r===g.q.eof||(0,v.Ch)(r))?(e.exit("mathFlowFence"),n(r)):t(r)}}},concrete:!0},Z={tokenize:function(e,n,t){let r=this;return function(n){return(0,v.Ch)(n)&&y("expected eol",n),e.enter(b.V.lineEnding),e.consume(n),e.exit(b.V.lineEnding),a};function a(e){return r.parser.lazy[r.now().line]?t(e):n(e)}},partial:!0};function N(e){let n=e.length-4,t=3,r,a;if((e[t][1].type===b.V.lineEnding||"space"===e[t][1].type)&&(e[n][1].type===b.V.lineEnding||"space"===e[n][1].type)){for(r=t;++r<n;)if("mathTextData"===e[r][1].type){e[n][1].type="mathTextPadding",e[t][1].type="mathTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)void 0===a?r!==n&&e[r][1].type!==b.V.lineEnding&&(a=r):(r===n||e[r][1].type===b.V.lineEnding)&&(e[a][1].type="mathTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function I(e){return e!==g.q.backslash||this.events[this.events.length-1][1].type===b.V.characterEscape}function P(e){let n=e.length-4,t=3,r,a;if((e[t][1].type===b.V.lineEnding||"space"===e[t][1].type)&&(e[n][1].type===b.V.lineEnding||"space"===e[n][1].type)){for(r=t;++r<n;)if("mathTextData"===e[r][1].type){e[n][1].type="mathTextPadding",e[t][1].type="mathTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)void 0===a?r!==n&&e[r][1].type!==b.V.lineEnding&&(a=r):(r===n||e[r][1].type===b.V.lineEnding)&&(e[a][1].type="mathTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function S(e){return e!==g.q.dollarSign||this.events[this.events.length-1][1].type===b.V.characterEscape}function T(e){let n=e.length-4,t=3,r,a;if((e[t][1].type===b.V.lineEnding||"space"===e[t][1].type)&&(e[n][1].type===b.V.lineEnding||"space"===e[n][1].type)){for(r=t;++r<n;)if("mathTextData"===e[r][1].type){e[n][1].type="mathTextPadding",e[t][1].type="mathTextPadding",t+=2,n-=2;break}}for(r=t-1,n++;++r<=n;)void 0===a?r!==n&&e[r][1].type!==b.V.lineEnding&&(a=r):(r===n||e[r][1].type===b.V.lineEnding)&&(e[a][1].type="mathTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),n-=r-a-2,r=a+2),a=void 0);return e}function M(e){return e!==g.q.backslash||this.events[this.events.length-1][1].type===b.V.characterEscape}var R=t(93362),_=t(45369),F=t(42426),q=t(65028),D=t(88366),E=t(37678),L=t(43404),U=[q.Z,[function(){let e=this.data();function n(n,t){let r=e[n]?e[n]:e[n]=[];r.push(t)}n("micromarkExtensions",{flow:{[g.q.dollarSign]:C,[g.q.backslash]:w},text:{[g.q.dollarSign]:{tokenize:function(e,n,t){let r=0,a,o;return function(n){return console.log("code!",n),e.enter("mathText"),e.enter("mathTextSequence"),function n(a){return a===g.q.dollarSign?(e.consume(a),r++,n):r<2?t(a):(e.exit("mathTextSequence"),i(a))}(n)};function i(l){return l===g.q.eof?t(l):l===g.q.dollarSign?(o=e.enter("mathTextSequence"),a=0,function t(i){return i===g.q.dollarSign?(e.consume(i),a++,t):a===r?(e.exit("mathTextSequence"),e.exit("mathText"),n(i)):(o.type="mathTextData",s(i))}(l)):l===g.q.space?(e.enter("space"),e.consume(l),e.exit("space"),i):(0,v.Ch)(l)?(e.enter(b.V.lineEnding),e.consume(l),e.exit(b.V.lineEnding),i):(e.enter("mathTextData"),s(l))}function s(n){return n===g.q.eof||n===g.q.space||n===g.q.dollarSign||(0,v.Ch)(n)?(e.exit("mathTextData"),i(n)):(e.consume(n),s)}},resolve:P,previous:S},[g.q.backslash]:[{tokenize:function(e,n,t){let r=[],a=[],o,i=this;return function(n){return y("start",n),n!==g.q.backslash&&j("expected `\\`",n),I.call(i,i.previous)&&j("expected correct previous",i.previous),e.enter("mathText"),e.enter("mathTextSequence"),function n(a){return(y("openingSequence",a,r.join(",")),a===g.q.backslash&&0===r.length||a===g.q.leftParenthesis&&1===r.length)?(e.consume(a),r.push(a),n):r.length<2?t(a):(e.exit("mathTextSequence"),s(a))}(n)};function s(i){return(y("gap",i),i===g.q.eof)?t(i):i===g.q.backslash?(o=e.enter("mathTextSequence"),a=[],function t(i){return(y("closingSequence",i,r.join(",")),i===g.q.backslash&&0===a.length||i===g.q.rightParenthesis&&1===a.length)?(e.consume(i),a.push(i),t):a.length===r.length?(e.exit("mathTextSequence"),e.exit("mathText"),n(i)):(o.type="mathTextData",l(i))}(i)):i===g.q.space?(e.enter("space"),e.consume(i),e.exit("space"),s):(0,v.Ch)(i)?(e.enter(b.V.lineEnding),e.consume(i),e.exit(b.V.lineEnding),s):(e.enter("mathTextData"),l(i))}function l(n){return(y("data",n),n===g.q.eof||n===g.q.space||n===g.q.backslash||(0,v.Ch)(n))?(e.exit("mathTextData"),s(n)):(e.consume(n),l)}},resolve:N,previous:I},{tokenize:function(e,n,t){let r=[],a=[],o,i=this;return function(n){return y("start",n),n!==g.q.backslash&&j("expected `\\`",n),M.call(i,i.previous)&&j("expected correct previous",i.previous),e.enter("mathText"),e.enter("mathTextSequence"),function n(a){return(y("openingSequence",a,r.join(",")),a===g.q.backslash&&0===r.length||a===g.q.leftSquareBracket&&1===r.length)?(e.consume(a),r.push(a),n):r.length<2?t(a):(e.exit("mathTextSequence"),s(a))}(n)};function s(i){return(y("gap",i),i===g.q.eof)?t(i):i===g.q.backslash?(o=e.enter("mathTextSequence"),a=[],function t(i){return(y("closingSequence",i,r.join(",")),i===g.q.backslash&&0===a.length||i===g.q.rightSquareBracket&&1===a.length)?(e.consume(i),a.push(i),t):a.length===r.length?(e.exit("mathTextSequence"),e.exit("mathText"),n(i)):(o.type="mathTextData",l(i))}(i)):i===g.q.space?(e.enter("space"),e.consume(i),e.exit("space"),s):(0,v.Ch)(i)?(e.enter(b.V.lineEnding),e.consume(i),e.exit(b.V.lineEnding),s):(e.enter("mathTextData"),l(i))}function l(n){return(y("data",n),n===g.q.eof||n===g.q.space||n===g.q.backslash||(0,v.Ch)(n))?(e.exit("mathTextData"),s(n)):(e.consume(n),l)}},resolve:T,previous:M}]}}),n("fromMarkdownExtensions",(0,h.N)()),n("toMarkdownExtensions",(0,h.O)())},{singleDollarTextMath:!1}],],A=[[R.Z,{detect:!0,subset:["arduino","bash","c","cpp","csharp","css","diff","go","graphql","java","javascript","json","kotlin","latex","less","lua","makefile","makefile","markdown","matlab","nginx","objectivec","perl","pgsql","php-template","php","plaintext","python-repl","python","r","ruby","rust","scss","shell","sql","swift","typescript","vbnet","wasm","xml","yaml",],ignoreMissing:!0},],_.Z,[F.Z,{newlines:!0}],],O={code:function(e){var n=e.inline,t=e.node,s=e.className,l=e.children,u=(0,o.Z)(e,["inline","node","className","children"]);if(n){var c=(0,D.B)(t),d=(0,E.T$)(c);return d?(0,i.jsx)(E.s8,{displayInfo:d}):(0,i.jsx)("code",(0,a.Z)((0,r.Z)({className:s},u),{children:l}))}var m,f=null===(m=null==s?void 0:s.split(" ").filter(function(e){return e.startsWith("language-")}))||void 0===m?void 0:m[0],h=f?f.split("-")[1]:"";return(0,i.jsx)(L.Z,{language:h,className:s,content:(0,D.B)(t),children:l})}};function z(e){var n=e.size,h=e.children,g=e.className,p=e.onSandboxLinkClick,v=(0,l.F)().theme,x=(0,m.hz)().has("tools2"),b=(0,u.useState)(""),y=b[0],j=b[1],w=(0,f.Z)();(0,u.useEffect)(function(){x&&w()&&t.e(949).then(t.bind(t,93949)).then(function(e){return j(e.SANDBOX_LINK_PREFIX)})},[x,j,w]);var k=(0,u.useMemo)(function(){return(0,a.Z)((0,r.Z)({},O),{a:function(e){var n=e.node,t=(0,o.Z)(e,["node"]),s=n.properties.href;return p&&x&&s.startsWith(y)?(0,i.jsx)("a",(0,a.Z)((0,r.Z)({},t),{onClick:p})):(0,i.jsx)("a",(0,r.Z)({},t))}})},[p,y,x]),C=(0,u.useCallback)(function(e){return e.startsWith(y)?e:(0,d.A)(e)},[y]);return(0,i.jsx)(c.D,{rehypePlugins:A,remarkPlugins:U,linkTarget:"_new",className:(0,s.Z)(g,"markdown prose w-full break-words dark:prose-invert","dark"===v?"dark":"light","small"===(void 0===n?"medium":n)&&"prose-xs"),transformLinkUri:C,components:k,children:h})}},69153:function(e,n,t){"use strict";t.d(n,{I:function(){return h},Z:function(){return c}});var r=t(14806),a=t(35250),o=t(34303);function i(){var e=(0,r.Z)(["flex p-4 bg-gray-50 dark:bg-white/5 rounded-md items-center gap-4 min-h-[71px]"]);return i=function(){return e},e}function s(){var e=(0,r.Z)(["w-10 text-2xl text-center"]);return s=function(){return e},e}function l(){var e=(0,r.Z)(["flex-1 leading-5"]);return l=function(){return e},e}function u(){var e=(0,r.Z)(["flex gap-4 flex-col text-sm"]);return u=function(){return e},e}function c(e){var n=e.icon,t=e.children;return(0,a.jsxs)(d,{children:[(0,a.jsx)(m,{children:n}),(0,a.jsx)(f,{children:t})]})}var d=o.Z.div(i()),m=o.Z.div(s()),f=o.Z.div(l()),h=o.Z.div(u())},76678:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(70079),a=t(500),o=t(62588);function i(){var e=(0,r.useContext)(a.A),n=(0,o.Z)().installedPlugins;return(0,r.useMemo)(function(){return n.filter(function(n){return e.has(n.id)})},[e,n])}},24058:function(e,n,t){"use strict";t.d(n,{dT:function(){return f},hZ:function(){return l},iO:function(){return u},p0:function(){return m},wu:function(){return h}});var r=t(64705),a=t(70079),o=t(59268),i=t(62676),s=t(62588),l=3,u=[["www.klarna.com","server.shop.app"],["apim.expedia.com","kayak.com"],],c="oai/enabledPluginIds",d=(0,o.ZP)(function(){var e=Array.from(new Set(i.m.getItem(c)));return{enabledPluginIds:new Set(e.splice(0,l))}});function m(){var e=(0,s.Z)().installedPlugins,n=d().enabledPluginIds;return(0,a.useMemo)(function(){return e.filter(function(e){return n.has(e.id)})},[n,e])}function f(e){!(e.length>l)&&d.setState(function(){return i.m.setItem(c,e),{enabledPluginIds:new Set(e)}})}function h(e){d.setState(function(n){if(n.enabledPluginIds.size>=l)return n;var t=(0,r.Z)(n.enabledPluginIds).concat([e]);return i.m.setItem(c,t),{enabledPluginIds:new Set(t)}})}},62588:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(87762),a=t(70079),o=t(82018),i=t(33264),s=t(66285);function l(){var e=(0,o.kP)().session,n=(0,s.hz)(),t=(0,r.a)(["installedAip"],function(){return i.ZP.getPlugins({offset:0,limit:20,isInstalled:!0,accessToken:null==e?void 0:e.accessToken})},{enabled:n.has("tools3")&&!!(null==e?void 0:e.accessToken),onError:function(e){console.error(e)}}),l=t.data,u=t.isLoading;return(0,a.useMemo)(function(){return{installedPlugins:l?l.items:[],isLoading:u}},[l,u])}},44819:function(e,n,t){"use strict";t.d(n,{BT:function(){return b},CS:function(){return x},G3:function(){return r},ZP:function(){return j},f_:function(){return h},m0:function(){return v},uU:function(){return g},xt:function(){return y}});var r,a,o=t(33861),i=t(31501),s=t(61079),l=t(64705),u=t(61432),c=t(70079),d=t(59268),m=t(13751),f=t(66285);(a=r||(r={})).Model="model",a.Temperature="temperature",a.Context="context";var h="gpt-4",g="model_cap_exceeded",p=(0,d.ZP)(function(){return{threadIds:new Set}});function v(e){p.setState(function(n){return{threadIds:new Set((0,l.Z)(n.threadIds).concat([e]))}})}var x=(0,d.ZP)()((0,m.tJ)(function(e){return{isoDate:"",setCapTimeout:function(n){e(function(){return{isoDate:n}})},clearCapTimeout:function(){e(function(){return{isoDate:""}})}}},{name:"oai/apps/capExpiresAt"}));function b(){var e=x(function(e){return e.isoDate}),n=x(function(e){return e.clearCapTimeout}),t=Date.now(),r=e&&new Date(e).getTime();return e&&r&&r<=t?(n(),null):e?h:null}function y(e,n){var t;return e?n[0].id:(null===(t=n.find(function(e){var n;return(n=e.id).includes("text-davinci")}))||void 0===t?void 0:t.id)||n[0].id}function j(e,n,t){var a,l,d=(0,u.useRouter)(),m=d.query,h=n||decodeURIComponent(m[r.Model]||""),g=(0,f.hz)(),v=p().threadIds,x=(0,c.useMemo)(function(){if(0!==e.length){var n,r=v.has(t),a=null===(n=e.find(function(e){return e.id===h}))||void 0===n?void 0:n.id,o=!r&&a||y(g.has("priority_driven_models_list"),e);return e.find(function(e){return e.id===o})}},[e,g,h,t,v]),b=parseFloat(m[r.Temperature]||"1"),j=(0,c.useCallback)(function(e,n){d.replace({pathname:d.basePath,query:(0,s.Z)((0,i.Z)({},m),(0,o.Z)({},e,encodeURIComponent(n)))},void 0,{shallow:!0})},[m,d]);return(0,c.useMemo)(function(){return{temperature:b,modelBackend:(null==x?void 0:x.id)||"",onChangeModelSetting:j}},[j,null==x?void 0:x.id,b])}},37678:function(e,n,t){"use strict";t.d(n,{Op:function(){return f},Qd:function(){return c},T$:function(){return d},s8:function(){return m}});var r=t(35250),a=t(1454),o=t(31425),i=t(79876),s=t(77064),l="&#8203;",u="oaicite:";function c(e,n){if(!n)return e;for(var t=n.length-1;t>=0;t--){var r=n[t],a=r.start_ix,o=r.end_ix,i=r.metadata,s=r.invalid_reason,c={index:t};i?c.metadata=i:s&&(c.invalid_reason=s),e=e.slice(0,a)+"".concat(l,"`").concat(u).concat(JSON.stringify(c),"`").concat(l)+e.slice(o)}return e}function d(e){if(!e.startsWith(u))return null;try{return JSON.parse(e.slice(u.length))}catch(n){return{index:-1}}}function m(e){var n,t=e.displayInfo;return(0,r.jsx)(s.$,{label:(0,r.jsx)(f,{pageInfo:t.metadata,invalidReason:t.invalid_reason}),placement:"top",offset:[0,3],leaveDelay:150,withArrow:!1,interactive:!0,wide:!0,children:(0,r.jsx)("a",{href:null===(n=t.metadata)||void 0===n?void 0:n.url,target:"_blank",rel:"noreferrer",className:"text-green-600 !no-underline",children:(0,r.jsx)("sup",{children:t.index+1})})})}function f(e){var n=e.pageInfo,t=e.invalidReason;return(0,r.jsx)("a",{href:null==n?void 0:n.url,target:"_blank",rel:"noreferrer",className:"!no-underline",children:(0,r.jsx)(s.u,{children:n?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex shrink-0 items-center justify-center",children:(0,r.jsx)(o.Z,{url:n.url,className:"my-0"})}),(0,r.jsx)("div",{className:"max-w-xs truncate text-xs",children:n.title}),(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(i.ZP,{icon:a.AlO,size:"xsmall"})})]}):(0,r.jsx)("div",{className:"text-red-500",children:t||"Invalid citation"})})})}},11699:function(e,n,t){"use strict";t.d(n,{_G:function(){return r},dD:function(){return c},dQ:function(){return m},lj:function(){return d}});var r,a,o,i=t(33861),s=t(70079);(o=r||(r={})).Small="small",o.Medium="medium",o.Large="large",o.XLarge="xlarge",o.Full="full";var l=(a={},(0,i.Z)(a,r.Small,640),(0,i.Z)(a,r.Medium,768),(0,i.Z)(a,r.Large,1024),(0,i.Z)(a,r.XLarge,1280),(0,i.Z)(a,r.Full,1536),a);function u(e){var n=function(){o(t(e))},t=function(e){return window.matchMedia(e).matches},r=(0,s.useState)(t(e)),a=r[0],o=r[1];return(0,s.useEffect)(function(){var t=window.matchMedia(e);return n(),t.addListener?t.addListener(n):t.addEventListener("change",n),function(){t.removeListener?t.removeListener(n):t.removeEventListener("change",n)}},[e]),a}function c(){return u("(max-width: ".concat(l[r.Small],"px)"))}function d(){return u("(max-width: ".concat(l[r.Medium],"px)"))}function m(){var e=c(),n=d(),t=u("(max-width: ".concat(l[r.Large],"px)")),a=u("(max-width: ".concat(l[r.XLarge],"px)"));return e?r.Small:n?r.Medium:t?r.Large:a?r.XLarge:r.Full}},80836:function(e,n,t){"use strict";t.d(n,{Cv:function(){return C},uV:function(){return j}});var r,a,o=t(35025),i=t(33468),s=t(37495),l=t(75106),u=t(43905),c=t(33861),d=t(31501),m=t(89874),f=t(64705),h=t(25769),g=t(84251),p=t.n(g),v=t(8844),x=t(36613),b=t(68619),y=(r={},(0,c.Z)(r,b.Jq.Root,b.uU.Unknown),(0,c.Z)(r,b.Jq.Prompt,b.uU.User),(0,c.Z)(r,b.Jq.Completion,b.uU.Assistant),(0,c.Z)(r,b.Jq.System,b.uU.System),r),j=(a={},(0,c.Z)(a,b.uU.Unknown,b.Jq.Root),(0,c.Z)(a,b.uU.System,b.Jq.System),(0,c.Z)(a,b.uU.User,b.Jq.Prompt),(0,c.Z)(a,b.uU.Assistant,b.Jq.Completion),(0,c.Z)(a,b.uU.Critic,b.Jq.Completion),(0,c.Z)(a,b.uU.Tool,b.Jq.Completion),a),w=new WeakMap,k=new WeakMap,C=function(){function e(n){(0,o.Z)(this,e),(0,s.Z)(this,w,{writable:!0,value:void 0}),(0,s.Z)(this,k,{writable:!0,value:void 0}),(0,l.Z)(this,w,n||e.createTree());var t=Object.values((0,i.Z)(this,w)).find(function(e){return e.type===b.Jq.Root});(0,l.Z)(this,k,(null==t?void 0:t.id)||"root")}var n=e.prototype;return n.getNode=function(e){return(0,i.Z)(this,w)[e]},n.getMessage=function(e){return(0,i.Z)(this,w)[e].message},n.getMessageId=function(e){return(0,i.Z)(this,w)[e].message.id},n.getMetadata=function(e){return(0,i.Z)(this,w)[e].metadata},n.getLeafFromNode=function(e){for(var n=(0,i.Z)(this,w)[e];;){if(0===n.children.length)return n;n=(0,i.Z)(this,w)[n.children.values().next().value]}},n.getParent=function(e){var n=(0,i.Z)(this,w)[e].parentId;return(0,i.Z)(this,w)[n]},n.getParentId=function(e){var n;return(null===(n=this.getParent(e))||void 0===n?void 0:n.id)||"root"},n.getBranchFromLeaf=function(e){for(var n=[],t=(0,i.Z)(this,w)[e];n.push(t),"root"!==t.type;)t=(0,i.Z)(this,w)[t.parentId];return n.reverse()},n.getChildrenFromNode=function(e){var n=this,t=(0,i.Z)(this,w)[e];return t?Array.from(t.children).map(function(e){return(0,i.Z)(n,w)[e]}):[]},n.getFirstPrompt=function(){for(var e,n,t=this.getNode((0,i.Z)(this,k));;){if(!t)return;if(t.type===b.Jq.Prompt||t.type===b.Jq.System&&(null===(e=t.message.metadata)||void 0===e?void 0:e.upload_filename))return t;t=(0,i.Z)(this,w)[null===(n=t.children)||void 0===n?void 0:n[0]]}},n.isMessageIncomplete=function(n){var t=this.getMessage(n);return e.getIsIncompleteFromMessage(t)},n.addNodeToEnd=function(e,n){if(!(0,i.Z)(this,w)[e])return(0,c.Z)({},n.id,n);(0,l.Z)(this,w,p()((0,i.Z)(this,w),(0,c.Z)({$merge:(0,c.Z)({},n.id,n)},e,{children:{$apply:function(e){return Array.from(new Set((0,f.Z)(e).concat([n.id])))}}})))},n.appendSystemMessageToRoot=function(e){var n,t,r=null===(n=this.getFirstPrompt())||void 0===n?void 0:n.parentId;if(r){var a=this.getNode(r),o=this.getNode(a.children[0]),s={id:e.id,children:a.children,parentId:a.id,message:e};(0,l.Z)(this,w,p()((0,i.Z)(this,w),(t={$merge:(0,c.Z)({},s.id,s)},(0,c.Z)(t,a.id,{children:{$set:[s.id]}}),(0,c.Z)(t,o.id,{parentId:{$set:s.id}}),t)))}},n.addNode=function(e,n,t,r,a){var o="string"==typeof n?{id:(0,v.Z)(),author:{role:y[r]},role:y[r],content:{content_type:"text",parts:[n]}}:n,i=(0,d.Z)({id:e,children:[],parentId:t,type:r,message:o},a?{metadata:a}:{});this.addNodeToEnd(t,i)},n.updateNode=function(e,n){(0,l.Z)(this,w,p()((0,i.Z)(this,w),(0,c.Z)({},e,n)))},n.updateNodeMessage=function(e,n){(0,l.Z)(this,w,p()((0,i.Z)(this,w),(0,c.Z)({},e,{message:{$set:n}})))},n.updateNodeText=function(e,n){(0,l.Z)(this,w,p()((0,i.Z)(this,w),(0,c.Z)({},e,{message:{content:{parts:{$set:[n]}}}})))},n.deleteNode=function(e){var n=(0,i.Z)(this,w),t=n[e],r=(0,m.Z)(n,[e].map(h.Z)),a=t.parentId;(0,l.Z)(this,w,p()(r,(0,c.Z)({},a,{children:{$apply:function(n){return n.filter(function(n){return n!==e})}}})))},n.getTextFromNode=function(n){return e.getTextFromMessage(this.getMessage(n))},n.getHasErrorFromNode=function(e){var n,t,r=this.getNode(e);return r&&((null===(n=r.metadata)||void 0===n?void 0:n.errType)==="danger"||(null===(t=r.metadata)||void 0===t?void 0:t.errType)==="warning")},n.getIsBlockedFromNode=function(e){var n,t,r=this.getNode(e);return r&&(null===(n=r.metadata)||void 0===n?void 0:n.errCode)===x.Dd&&(null===(t=r.metadata)||void 0===t?void 0:t.errType)==="danger"},n.getTextFromThread=function(n){return this.getBranchFromLeaf(n).filter(function(e){return e.type!==b.Jq.Root&&e.type!==b.Jq.System}).map(function(n){return e.getTextFromMessage(n.message)}).join("\n\n")},n.getTextFromLastNTurns=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=function(n){var t=n.message,r=e.getMessageType(t),a=n.message.author.role===b.uU.System,o=n.message.author.role===b.uU.Tool;return a||o&&!("code"===r||"execution_output"===r||"system_error"===r)};return this.getConversationTurns(n,a).slice(-t).map(function(n){var t=n.messages.map(function(n){return e.getTextFromMessage(n.message)}).filter(function(e){return""!==e}).join("\n");return r?"[".concat(n.role,"]\n").concat(t):t}).join("\n")},n.getConversationTurns=function(n,t){var r=this,a=[];return this.getBranchFromLeaf(n).forEach(function(n){var o=n.id,s=n.parentId,l=n.message,u=n.metadata;if(null==t||!t(n)){var c=a[a.length-1];(null==c?void 0:c.role)===e.getRoleFromMessage(l)||e.getRoleFromMessage(l)===b.uU.Tool?a[a.length-1].messages.push((0,d.Z)({nodeId:o,parentId:s,message:l},u)):a.push({role:e.getRoleFromMessage(l),messages:[(0,d.Z)({nodeId:o,parentId:s,message:l},u),],variantIds:s?Array.from((0,i.Z)(r,w)[s].children):[o]})}}),a},n.getLastValidNode=function(e){for(var n,t=this.getNode(e);t&&t&&(null===(n=t.metadata)||void 0===n?void 0:n.err);)t=this.getNode(t.parentId);return t},n.getParentPromptNode=function(e){for(var n,t,r=this.getNode(e);r&&r&&(null===(n=r.message)||void 0===n?void 0:null===(t=n.author)||void 0===t?void 0:t.role)!==b.uU.User;)r=this.getNode(r.parentId);return r},e.createTree=function(){return{root:{id:"root",children:[],parentId:"",type:b.Jq.Root,message:e.createRootMessage()}}},e.createRootMessage=function(){return{id:(0,v.Z)(),author:{role:y[b.Jq.Root]},role:y[b.Jq.Root],content:{content_type:"text",parts:[]}}},e.getIsIncompleteFromMessage=function(e){var n,t;return(null===(n=e.metadata)||void 0===n?void 0:null===(t=n.finish_details)||void 0===t?void 0:t.type)==="max_tokens"},e.getWasInterruptedFromMessage=function(e){var n,t;return(null===(n=e.metadata)||void 0===n?void 0:null===(t=n.finish_details)||void 0===t?void 0:t.type)==="interrupted"},e.getIsContinuedFromMessage=function(e){var n;return(null===(n=e.metadata)||void 0===n?void 0:n.message_type)==="continue"},e.getModelFromMessage=function(e){var n;return null===(n=e.metadata)||void 0===n?void 0:n.model_slug},e.getTextFromMessage=function(e){if(e.content.content_type.startsWith("tether_b"))return e.content.text;switch(e.content.content_type){case"text":return e.content.parts.join("");case"code":case"execution_output":case"system_error":return e.content.text;case"system_message":var n=e.content.text,t=!0,r=!1,a=void 0;try{for(var o,i=Object.values(e.content.tools_section)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var s=o.value;n+="\n\n".concat(s)}}catch(l){r=!0,a=l}finally{try{t||null==i.return||i.return()}finally{if(r)throw a}}return n;default:return""}},e.getMessageType=function(e){return e.content.content_type},e.getIsTextTypeFromMessage=function(n){return"text"===e.getMessageType(n)},e.getRequestIdFromConversationTurn=function(e){var n=e.messages[e.messages.length-1];return this.getIsContinuedFromMessage(n.message)?n.nodeId:e.messages[0].nodeId},e.getRoleFromMessage=function(e){var n;return(null===(n=e.author)||void 0===n?void 0:n.role)||e.role},e.getNameFromMessage=function(e){var n,t;return(null===(n=e.author)||void 0===n?void 0:n.name)||(null===(t=e.author)||void 0===t?void 0:t.role)||e.role},e.getRecipientFromMessage=function(e){return e.recipient||""},(0,u.Z)(e,[{key:"isFirstCompletion",get:function(){var e=this.getFirstPrompt();if(e){var n=(0,i.Z)(this,w)[e.children[0]];if(n&&0===n.children.length)return!0}return!1}}]),e}()},60612:function(e,n,t){"use strict";var r=t(70079);n.Z=function(){var e=(0,r.useRef)(!1);return(0,r.useEffect)(function(){return e.current=!0,function(){e.current=!1}},[]),(0,r.useCallback)(function(){return e.current},[])}},62676:function(e,n,t){"use strict";t.d(n,{m:function(){return o}});var r=t(35025);t(70079);var a=window.localStorage,o=function(){function e(){(0,r.Z)(this,e)}return e.setItem=function(e,n){if(!a)throw Error("You cannot set localStorage server-side");a.setItem(e,JSON.stringify(n))},e.getItem=function(e){if(a){var n=a.getItem(e);return"string"==typeof n?JSON.parse(n):n}return null},e.removeItem=function(e){if(a)return a.removeItem(e)},e}()},36613:function(e,n,t){"use strict";t.d(n,{Dd:function(){return i},Mf:function(){return s},_I:function(){return u},sK:function(){return l}});var r=t(95182),a=t.n(r),o=t(33264),i="content_policy",s={errType:"warning",errCode:i},l={err:"Contents may violate our content policy",errType:"danger",errCode:i};function u(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=a()(e.length,0,4e3),s=a()(e.length-i,0,e.length-1),l=n?e.substring(s,e.length):e;return l?o.ZP.runModerationApi(l,t,r).then(function(e){var n,t;return{isBlocked:Boolean(e.blocked),isFlagged:Boolean(e.flagged)}}).catch(function(e){return console.error(e),{isBlocked:!1,isFlagged:!1,error:e}}):Promise.resolve({isBlocked:!1,isFlagged:!1})}}},function(e){e.O(0,[798,960,786,762,424,174,360,113,264,14,774,888,179],function(){return e(e.s=49529)}),_N_E=e.O()}]);